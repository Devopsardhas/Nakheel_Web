@using Microsoft.AspNetCore.Http;
@using Nakheel_Web.Models.AccountsMaster;
@using Newtonsoft.Json;
@using static Nakheel_Web.Authentication.Common;
@inject IHttpContextAccessor HttpContextAccessor;
@{
    var str = HttpContextAccessor.HttpContext!.Session.GetString("Login");
    string Des = Decrypt(str!);
    Login_ LoginClass = JsonConvert.DeserializeObject<Login_>(Des!)!;
}

@{
    Layout = null;
}

<style>
    .error {
        color: red;
    }

    .select2-search__field {
        text-align: center !important;
    }

    .select2-container--bootstrap-5 .select2-selection--multiple .select2-search .select2-search__field {
        width: 100%;
        height: 1.5rem;
        margin-top: -24px;
        margin-left: 0;
        font-family: inherit;
        line-height: 1.5;
        background-color: transparent;
    }
</style>
<style>
    .form-label, .form-control {
        margin-bottom: 0.5rem;
        font-weight: 500;
        font-family: 'Nakheel-Textregular';
        font-size: 13px;
    }

    label {
        font-weight: 500;
        font-family: 'Nakheel-Textregular' !important;
        font-size: 13px;
    }

    table {
        font-family: 'Nakheel-Textregular';
    }

    span {
        font-weight: 500;
        font-family: 'Nakheel-Textregular';
        font-size: 15px;
    }

    .tdtxt {
        color: #00617F;
    }

    .font-bold {
        color: #00263a !important;
    }

    .table > :not(caption) > * > * {
        padding: 0.35rem 0.35rem !important;
        background-color: var(--bs-table-bg);
        border-bottom-width: 1px;
        -webkit-box-shadow: inset 0 0 0 9999px var(--bs-table-accent-bg);
        box-shadow: inset 0 0 0 9999px var(--bs-table-accent-bg);
    }

    .submit_Req_Approval {
        background-color: #3CB371;
    }

    .submit_Req_Approval_Hse {
        background-color: #3CB371;
    }

    .Zone_Details_Approve {
        background-color: #3CB371;
    }

    .HSE_Details_Approve {
        background-color: #3CB371;
    }
</style>

<style>
    #map-canvas_view {
        height: 300px;
        width: 100%;
        border-radius: 14px;
    }

    .tblround {
        border-collapse: collapse;
        border-radius: 1em;
        overflow: hidden
    }
</style>

@model Nakheel_Web.Models.ControlOfWorkMaster.Ptw_Confined_Space_Add;

<div class="" id="viewConfinedRequest">
    <div class="row">
        <div class="col-12">
            <div class="col-xxl-12 mb-5 mb-xxl-0">
                @if (Model != null)
                {
                    @if (Model._Get_Zone_Reject_List != null)
                    {
                        <div class="row">
                            <div class="col-md-12">
                                <table id="Reject_Reason" class="table table-striped dt-responsive nowrap tblround" style="width:100%;">
                                    <thead>
                                        <tr>
                                            <th>Unique Id</th>
                                            <th>Reject Reason Description</th>
                                            <th>Rejected By</th>
                                        </tr>
                                    </thead>
                                    <tbody id="Reject_Reason_List">
                                        @foreach (var item in Model._Get_Zone_Reject_List)
                                        {
                                            <tr>
                                                <td>@item.Unique_Id</td>
                                                <td>@item.Remarks</td>
                                                <td>@item.Zone_Approver_Name</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    }
                    <div class="">
                        <input type="hidden" id="Unique_Id" value="@Model.Unique_Id">
                        <input type="hidden" id="V_Confined_ID" value="@Model.CSP_Id">
                        <input type="hidden" value="@Model.Zone_Id" id="Zone_Id" class="Zone_Ids">
                        <input type="hidden" value="@Model.Community_Id" id="Community_Id" class="Community_Ids">
                        <input type="hidden" value="@Model.Building_Id" id="Building_Id">
                        <input type="hidden" value="@Model.Latitude" id="Loc_Latitude">
                        <input type="hidden" value="@Model.Longitude" id="Loc_Longitude">
                        <table class="table tab">
                            <tbody>
                                <tr>
                                    <td><b class="font-bold">Confined Reference no</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Unique_Id</td>
                                    @*<td><b class="font-bold">Date and Time Of Observation</b></td>
                                <td>:</td>
                                <td class="tdtxt">@Model.Date_Time_of_Observation</td>*@
                                    <td><b class="font-bold">Business Unit</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Business_Unit_Name</td>
                                    <td><b class="font-bold">Zone</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Zone_Name</td>
                                </tr>

                                <tr>
                                    <td><b class="font-bold">Community</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Community_Name</td>
                                    <td><b class="font-bold">Building</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Building_Name</td>
                                    <td><b class="font-bold">Confined Space Work Location</b></td>
                                    <td>:</td>
                                    <td class="tdtxt"><img src="/assets/images/viewLoc.png" style="cursor:pointer;width:20px;" data-bs-toggle="modal" data-bs-target=".Con_Location"></td>
                                </tr>

                                <tr>

                                    <td><b class="font-bold">Exact Location</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Exact_Loc_Address</td>

                                </tr>


                                @*<tr>
                            @if (Model.Business_Unit_Type != "0")
                            {
                            var obane = "";
                            <td><b class="font-bold">Business Unit Type</b></td>
                            <td>:</td>
                            @if (Model.Business_Unit_Type == "Party")
                            {
                            obane = "JOP 3rd Party";
                            }
                            else if (Model.Business_Unit_Type == "JOP_Common")
                            {
                            obane = "JOP- Common Area";
                            }
                            else
                            {
                            obane = "Master Community";
                            }
                            <td class="tdtxt" style="word-break: break-all">@obane</td>
                            }
                            </tr>*@
                            </tbody>
                        </table>

                        <div class="col-md-12">
                            <label class="form-label">Documents Submitted</label>

                        </div>
                        <table class="table tab">
                            <tbody>
                                <tr>
                                    <td><b class="font-bold">Method Statement</b></td>
                                    <td>:</td>
                                    <td>
                                        @{
                                            if (Model._Method_Statement_Files != null)
                                            {
                                                foreach (var item in Model._Method_Statement_Files)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.Method_File_Path" target="_blank"></a>
                                                }
                                            }
                                        }
                                    </td>
                                    <td><b class="font-bold">Risk Assessment</b></td>
                                    <td>:</td>
                                    <td>
                                        @{
                                            if (Model._Risk_Assess_Files != null)
                                            {
                                                foreach (var item in Model._Risk_Assess_Files)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.Risk_File_Path" target="_blank"></a>
                                                }
                                            }
                                        }
                                    </td>
                                    <td><b class="font-bold">Emergency Plan</b></td>
                                    <td>:</td>
                                    <td>
                                        @{
                                            if (Model._Emr_Plan_Files != null)
                                            {
                                                foreach (var item in Model._Emr_Plan_Files)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.Emr_File_Path" target="_blank"></a>
                                                }
                                            }
                                        }
                                    </td>
                                    <td><b class="font-bold">HSE Plan</b></td>
                                    <td>:</td>
                                    <td>
                                        @{
                                            if (Model._HSE_Plan_Files != null)
                                            {
                                                foreach (var item in Model._HSE_Plan_Files)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.Hse_File_Path" target="_blank"></a>
                                                }
                                            }
                                        }
                                    </td>
                                    <td><b class="font-bold">Staff competency Certificate</b></td>
                                    <td>:</td>
                                    <td>
                                        @{
                                            if (Model._Staff_Comptency_Files != null)
                                            {
                                                foreach (var item in Model._Staff_Comptency_Files)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.File_Path" target="_blank"></a>
                                                }
                                            }
                                        }
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="col-md-12">
                            <label class="form-label">Requester Details & Submission</label>

                        </div>
                        <table class="table tab">
                            <tbody>
                                <tr>
                                    <td><b class="font-bold">Manager Incharge</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Contractor_Name</td>
                                    <td><b class="font-bold">Company Name</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Company_Name</td>
                                    <td><b class="font-bold">Contractor Title/No </b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Contrator_Title_No</td>

                                </tr>
                                <tr>
                                    <td><b class="font-bold">Competent Person</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Competent_Person_Name</td>
                                    <td><b class="font-bold">Competent Number</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Competent_Number</td>
                                    <td><b class="font-bold">Contract Start Date</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Contractor_Start_Date</td>

                                </tr>
                                <tr>
                                    <td><b class="font-bold">Contract End Date</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.Contractor_End_Date</td>
                                    <td><b class="font-bold">HSE Officer Name</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.HSE_Officer_Name</td>
                                    <td><b class="font-bold">HSE Mobile Number</b></td>
                                    <td>:</td>
                                    <td class="tdtxt">@Model.HSE_Mobile_Number</td>
                                </tr>
                                @* <tr>
                            <td><b class="font-bold">Contact</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Contact</td>
                            <td><b class="font-bold">Date and time</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Date_and_Time</td>

                            </tr>*@
                                @*<tr>
                            <td><b class="font-bold">Approved Method Statement</b></td>
                            <td>:</td>
                            <td class="tdtxt"><input type="radio" name="" class="form-check-input" checked style="vertical-align:sub">&nbsp;<span>@Model.Approved_Method</span></td>
                            </tr>*@
                            </tbody>
                        </table>
                        <div class="row col-md-12">
                            <label for="example-number-input" class="col-md-4 col-form-label">Description Of Work To Be Performed And Purpose Of Entry</label>
                            <label class="tdtxt">@Model.Description_of_Work</label>
                        </div>
                        <br>
                        @* <div class="row">
                    <div class="col-6">
                    <div class="row">
                    <label for="" class="col-md-5 col-form-label">Approved Method Statement</label>
                    <input type="radio" name="" class="form-check-input" checked style="vertical-align:sub">&nbsp;<span>@Model.Night_Schedule</span>
                    </div>
                    </div>
                    </div>*@

                        <div class="col-md-12">
                            <label class="col-form-label">
                                Precautions:<br>
                                (The Competent person or his supervisor should tick the appropriate precautions which have been taken)
                            </label><br>
                            <table class="table table-striped dt-responsive nowrap tblround table-sm">
                                <thead>
                                    <tr>
                                        <th>Questionnaire</th>
                                        <th>Action</th>
                                        <th>Remarks</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model._Add_CSP_Ques!)
                                    {
                                        <tr class="clstr">
                                            <td style="display:none;"><input type="hidden" value="@item.Ques_CSP_ID" class="Confine_Question_Id" /></td>
                                            <td>
                                                <label disabled class="col-form-label Questionaire_Id" asp-for="@item.CSP_Ques_Name">@item.CSP_Ques_Name </label>
                                            </td>

                                            <td align="left" valign="middle"><label class="col-form-label">@item.CSP_Ques_Radio_Btn</label></td>
                                            <td align="left" valign="middle"><label class="col-form-label">@item.CSP_Remarks</label></td>

                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        <div class="row col-md-12">
                            <label for="example-number-input" class="col-md-4 col-form-label">Additional Precautions</label>
                            <label class="tdtxt">@Model.Additional_Precautions</label>
                        </div>
                        <table class="table tab ">
                            <tbody>
                                <tr>
                                    <td><b class="">Work Duration From Date :</b><b class="tdtxt">&nbsp;&nbsp;@Model.Work_Duration_From_Date</b></td>
                                    <td><b class="">Work Duration To Date :</b><b class="tdtxt">&nbsp;&nbsp;@Model.Work_Duration_To_Date</b></td>
                                    @*  <td><b class="">Work Duration From Date</b></td>
                                <td>:</td>
                                <td class="tdtxt">@Model.Work_Duration_From_Date</td>
                                <td><b class="">Work Duration To Date</b></td>
                                <td>:</td>
                                <td class="tdtxt">@Model.Work_Duration_To_Date</td>*@
                                    @* <td><b class="">Night Shedule</b></td>
                                <td>:</td>
                                <td class="tdtxt"><input type="radio" name="" class="form-check-input" checked style="vertical-align:sub">&nbsp;<span>@Model.Night_Schedule</span></td>*@
                                </tr>
                            </tbody>
                        </table>

                        <div class="col-md-5">
                            <table class="table tab">
                                <tbody>
                                    <tr>
                                        <td><b class="font-bold">Service Provider's Permit Signed by HSE & Engineer/Supervisor</b></td>
                                        <td>:</td>
                                        <td>
                                            @{
                                                if (Model._Sp_Signed_Files != null)
                                                {
                                                    foreach (var item in Model._Sp_Signed_Files)
                                                    {
                                                        <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@item.Sign_File_Path" target="_blank"></a>
                                                    }
                                                }
                                            }
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-lg-10">
                            <h4 class="card-title">Service Providers Declaration</h4>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <label for="example-tel-input" class="col-md-12 col-form-label"><input disabled type="checkbox" id="Declare_Chk" value="@Model.Declare_Chk" name="Declare_Chk" class="Declare_Chk" checked />&nbsp; We confirm that the high risk activity will be carried out as per method statement, risk assessment and permit requirements under the  supervision of competent supervisor and HSE staff. Additional permit for each shift shall be issued by the service provider.Accepted by </label>
                            </div>
                        </div>
                        <table class="table tab">
                            <tbody>
                                <tr>
                                    <td><b class="">Name :</b><b class="tdtxt">&nbsp;&nbsp;@Model.Declare_Name</b></td>
                                    <td><b class="">Designtion :</b><b class="tdtxt">&nbsp;&nbsp;@Model.Declare_Designation</b></td>
                                </tr>
                            </tbody>
                        </table>

                        @if (Model._Ptw_History_List != null && Model._Ptw_History_List.Count != 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="accordionExample">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        History of Approval
                                                    </button>
                                                </h2>
                                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Employee Name</th>
                                                                    <th>Role</th>
                                                                    <th>Date and Time</th>
                                                                    <th>Approve Date</th>
                                                                    <th>Status</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Ptw_History_List)
                                                                {
                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Emp_Id</td>
                                                                        <td align="left" valign="middle">@item.Role_Id</td>
                                                                        <td align="left" valign="middle">@item.Updated_DateTime</td>
                                                                        <td align="left" valign="middle">@item.Updated_DateTime</td>
                                                                        <td align="left" valign="middle">@item.Status</td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }

                    </div>

                    <div class="modal fade Con_Location" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-lg modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="myExtraLargeModalLabel">Confined Space Work Location</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <div id="map-canvas_view"></div>
                                    </div>


                                </div>
                            </div><!-- /.modal-content -->
                        </div><!-- /.modal-dialog -->
                    </div>

                    <br />

                }
                @if (Model!.Status == "Zone Supervisor Approval Pending")
                {
                    @if (LoginClass.Role_Id == "5")
                    {
                        <div class="row">
                            <div class="col-lg-10"> <h4 class="card-title">Approval</h4></div>
                            <br />
                            <div style="display:none;">
                                <div class="form-group">
                                    <input class="col-form-label" name="CSP_Zone_Id" id="CSP_Zone_Id" value="0">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="col-form-label" for="Email_Id">Approver name<span class="requ">*</span></label>
                                    <input type="text" class="form-control" value="@LoginClass.First_Name" id="C_Approve_Name" name="C_Approve_Name" readonly>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="col-form-label" for="Email_Id">Designation<span class="requ">*</span></label>
                                    <input type="text" class="form-control" value="@LoginClass.Role_Name" id="C_Designation" name="C_Designation" readonly>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label class="col-form-label" for="Email_Id">Date<span class="requ">*</span></label>
                                    <input type="date" class="form-control" disabled id="Approve_Date" name="Approve_Date">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label class="col-form-label" for="Email_Id">Comments<span class="requ">*</span></label>
                                    <textarea class="form-control" id="Csp_Req_Zone_Comm" name="Csp_Req_Zone_Comm"></textarea>
                                </div>
                            </div>


                            <br />
                            @if (Model!.Status == "Zone Supervisor Approval Pending")
                            {
                                @if (LoginClass.Role_Id == "5")
                                {
                                    <div class="row">
                                        <div class="col-lg-5"></div>
                                        <div class="col-lg-7">
                                            <button type="button" class="btn btn-success waves-effect waves-light submit_Req_Approval" id="" onclick="Approval_Btn()">
                                                <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Approve
                                            </button>
                                            <button class="btn btn-danger waves-effect waves-light submit" type="button" data-bs-toggle="modal" data-bs-target=".se-reject">
                                                Reject <i class="bx bx-list-plus"></i>
                                            </button>
                                        </div>
                                    </div>
                                }
                            }



                        </div>
                        <div class="modal fade se-reject" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-lg modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="myExtraLargeModalLabel">Reject Confined Space</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div style="display:none;">
                                                <div class="form-group">
                                                    <input class="form-control" name="COW_Reject_Id" id="COW_Reject_Id" value="0">
                                                    <input class="form-control" name="Reject_Reason_Stage_SE" id="Reject_Reason_Stage" value="Rejected By">
                                                </div>
                                            </div>

                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label for="example-search-input" class="form-model" style="color:black;">Reason For Reject</label>
                                                    <textarea class="form-control" rows="1" cols="40" style="height: 150px;" id="Reject_Reason_Description_Con" name="Reject_Reason_Description_Con" required minlen="1"></textarea>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="">
                                            <div style="text-align:center;">
                                                <button type="submit" class="btn btn-success" onclick="Btn_Reject_Confined_Request()"> Submit</button>
                                            </div>
                                        </div>

                                    </div>
                                </div><!-- /.modal-content -->
                            </div><!-- /.modal-dialog -->
                        </div>
                    }
                }

                @if (Model!.Status == "HSE Staff/HSE Team Approval Pending")
                {
                    @if (LoginClass.Role_Id == "9" || LoginClass.Role_Id == "10" || LoginClass.Role_Id == "11")
                    {
                        <div>
                            <div class="row">
                                <br />

                                <div class="col-lg-10"> <h4 class="card-title">Approval</h4></div>
                                <br />
                                <br />
                                <div style="display:none;">
                                    <div class="form-group">
                                        <input class="col-form-label" name="CSP_Hse_Id" id="CSP_Hse_Id" value="0">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="col-form-label" for="Email_Id">Approver name<span class="requ">*</span></label>
                                        <input type="text" class="form-control" value="@LoginClass.First_Name" id="C_Hse_Approver_Name" name="C_Hse_Approver_Name" readonly>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="col-form-label" for="Email_Id">Designation<span class="requ">*</span></label>
                                        <input type="text" class="form-control" value="@LoginClass.Role_Name" id="C_Hse_Designation" name="C_Hse_Designation" readonly>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label class="col-form-label" for="Email_Id">Date<span class="requ">*</span></label>
                                        <input type="date" class="form-control" disabled id="Hse_Approve_Date" name="Hse_Approve_Date">
                                    </div>
                                </div>

                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="col-form-label" for="Email_Id">Comments<span class="requ">*</span></label>
                                        <textarea class="form-control" id="Csp_Req_Hse_Comm" name="Csp_Req_Hse_Comm"></textarea>
                                    </div>
                                </div>

                                <br />
                                <div class="row">
                                    <div class="col-lg-5"></div>
                                    <div class="col-lg-7">
                                        <button type="button" class="btn btn-success waves-effect waves-light submit_Req_Approval_Hse" onclick="Func_Hse_Approve()">
                                            <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Approve
                                        </button>
                                        <button class="btn btn-danger waves-effect waves-light submitHse" type="button" data-bs-toggle="modal" data-bs-target=".Hse-reject">
                                            Reject <i class="bx bx-list-plus"></i>
                                        </button>
                                    </div>
                                </div>

                            </div>


                            <div class="modal fade Hse-reject" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                                <div class="modal-dialog modal-lg modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="myExtraLargeModalLabel">Reject Confined Space</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div style="display:none;">
                                                    <div class="form-group">
                                                        <input class="form-control" name="Hse_COW_Reject_Id" id="Hse_COW_Reject_Id" value="0">
                                                        <input class="form-control" name="Reject_Reason_Stage_SE" id="Reject_Reason_Stage" value="Rejected By">
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="col-md-12">
                                                        <label for="example-search-input" class="form-model" style="color:black;">Reason For Reject</label>
                                                        <textarea class="form-control" rows="1" cols="40" style="height: 150px;" id="Reject_Reason_Description_Hse" name="Reject_Reason_Description_Hse" required minlen="1"></textarea>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="">
                                                <div style="text-align:center;">
                                                    <button type="submit" class="btn btn-success" onclick="Btn_Reject_Confined_Hse()"> Submit</button>
                                                </div>
                                            </div>

                                        </div>
                                    </div><!-- /.modal-content -->
                                </div><!-- /.modal-dialog -->
                            </div>

                        </div>
                    }
                }

                @if (Model!.Status == "Zone Supervisor Rejected the Evidence" || Model.Status == "HSE Staff/HSE Team Rejected the Evidence")
                {
                    @if (LoginClass.Role_Id == "16")
                    {
                        @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="AccordionRenewal">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        Renewal List
                                                    </button>
                                                </h2>
                                                <div id="collapseRenewal" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Competent Person</th>
                                                                    <th>Renewal From Date</th>
                                                                    <th>Renewal To Date</th>
                                                                    <th>Remarks</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Get_Renewal_Details)
                                                                {

                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Competent_Person</td>
                                                                        <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                        <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                        @if (@item.Remarks != null)
                                                                        {
                                                                            <td align="left" valign="middle">@item.Remarks</td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td align="left" valign="middle">----</td>
                                                                        }

                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br />
                        }
                        <br />
                        @if (Model._Evidence_Details != null)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                if (@item.Action_Radio_Btn == "Evidence")
                                {
                                    var subno = 1;
                                    <form id="form_Edit_Evidence">
                                        <div class="col-6">
                                            <div class="row">
                                                <label for="" class="col-md-3 col-form-label">Work Completed?</label>

                                                <div class="col-md-2 col-form-label">
                                                    <div id="ConfineYes" class="">
                                                        <label for="Yes"> <input id="Evidence_Btn" checked class="Edit_Renewal required" name="Edit_Renewal" type="radio" value="Evidence" />&nbsp;Yes </label>
                                                    </div>
                                                </div>
                                                <div class="col-md-2 col-form-label">
                                                    <div id="ConfineNo" class="floatBlock">
                                                        <label for="No"> <input id="Renewal_Btn" disabled class="Edit_Renewal required" name="Edit_Renewal" type="radio" value="Renewal" />&nbsp;No </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row" id="Edit_Renewal_Upload_Div">

                                            <h4>Work Completion Details</h4>
                                            <div class="row">
                                                <input type="hidden" id="CSPAddId" value="@item.CSP_Add_Id" />
                                                <div class="col-3">
                                                    <div class="">
                                                        <label class="col-md-10 col-form-label" for="example-password-input">Competent Person <span class="requ">*</span></label>
                                                        <div class="">
                                                            <input type="text" readonly class="form-control required" value="@Model.Competent_Person_Name" id="Competent_Person" name="Competent_Person" autocomplete="off">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-3">
                                                    <div class="">
                                                        <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended<span class="requ">*</span></label>
                                                        <div class="">
                                                            <input type="date" class="form-control required" value="@item.Date_Time_Work_Comp" id="C_Complete_Date" name="C_Complete_Date">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-3">
                                                    <div class="">
                                                        <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return<span class="requ">*</span></label>
                                                        <div class="">
                                                            <input type="date" class="form-control required" value="@item.Date_Time_Safe_Return" id="C_Return_Date" name="C_Return_Date">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-3">
                                                    <div class="">
                                                        <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Upload <span class="requ">*</span></label>
                                                        @{
                                                            @if (item._Add_Renewal_Evidences != null)
                                                            {
                                                                foreach (var photos in item._Add_Renewal_Evidences!)
                                                                {
                                                                    <input type="hidden" value="@photos.Evidence_File_Id" class="Evidence_File_Id" />
                                                                    <input type="hidden" value="@photos.Evidence_File_Path" class="Comp_Evid_Pdf" />
                                                                    <a class="mdi mdi-file-pdf CompEvidPdf" style="color: red;font-size: 20px" href="@photos.Evidence_File_Path" target="_blank"></a>
                                                                }
                                                            }

                                                        }
                                                        <div class="">
                                                            <input id="Renewal_Files" name="Renewal_Files" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Renewal_File_Upload('Renewal_Files','UploadEvidence','CompEvidPdf')" />
                                                            <input type="hidden" class="UploadEvidence">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-lg-10"> <h4 class="card-title">Add Closure Details</h4></div>
                                                <div class="col-lg-2">
                                                    <button type="button" id="btn_add" class="btn btn-success waves-effect waves-light" style="float: right;" onclick="FnAddToolsDetails()"><i class="mdi mdi-plus me-1"></i> Add</button>
                                                </div>
                                            </div>
                                            <br />
                                            <br />
                                            <hr />
                                            <table id="tblToolsList" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                                <thead>
                                                    <tr>
                                                        <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                                        <th>Attachments</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="GetToolsCount">

                                                    @if (item._Add_Personnel_Tools != null)
                                                    {

                                                        @foreach (var tools in item._Add_Personnel_Tools)
                                                        {
                                                            <tr>
                                                                <td>
                                                                    <div class="form-group">
                                                                        <input type="hidden" id="CSPPersToolsId" class="CSPPersToolsId" value="@tools.CSP_Pers_Tools_Id" /> <input type="text" class="form-control Tools_Name_@subno Tools_Name required" id="Tools_Name_@subno" value="@tools.Personnel_Tools_Name" name="Tools_Name" autocomplete="off">
                                                                    </div>
                                                                </td>
                                                                <td>

                                                                    <div class="form-group">
                                                                        @{
                                                                            @if (tools._Closure_Evidences != null)
                                                                            {
                                                                                foreach (var cls_photos in tools._Closure_Evidences!)
                                                                                {
                                                                                    <input type="hidden" value="@cls_photos.CSP_Pers_Tools_Id" class="Cls_File_Tools_Id" />
                                                                                    <input type="hidden" value="@cls_photos.Closure_File_Path" class="cls_Evd_files" />
                                                                                    <a class="mdi mdi-file-pdf Cls_Evid_Pdf_@subno" id="" style="color: red;font-size: 20px" href="@cls_photos.Closure_File_Path" target="_blank"></a>
                                                                                }
                                                                            }

                                                                        }
                                                                        <input id="Closure_Files_@subno" name="Closure_Files" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Closure_File_Upload('Closure_Files_@subno','UploadEvidence_Closure_@subno','Cls_Evid_Pdf_@subno')" />
                                                                        <input type="hidden" class="UploadEvidence_Closure_@subno UploadEvidence_Closure" />
                                                                    </div>
                                                                </td>
                                                                @if (@subno != 1)
                                                                {
                                                                    <td>
                                                                        <button class="btn btn-primary" id="DataDeleteTools" value="Remove">Remove</button>
                                                                    </td>
                                                                }

                                                            </tr>
                                                            subno++;
                                                        }
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="row" id="Edit_Renewal_date_Div" style="display:none;">
                                            <div class="col-3">
                                                <div class="">
                                                    <label class="col-md-10 col-form-label" for="example-password-input">Competent Person <span class="requ">*</span></label>
                                                    <div class="">
                                                        <input type="text" readonly class="form-control required" value="@Model.Competent_Person_Name" id="Ren_Competent_Person" name="Ren_Competent_Person" autocomplete="off">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="">
                                                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                                                    <div class="">
                                                        <input type="date" class="form-control required" id="SP_From_Date" name="SP_From_Date" placeholder="">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="">
                                                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                                                    <div class="">
                                                        <input type="date" class="form-control required" id="SP_To_Date" name="SP_To_Date" placeholder="">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="">
                                                    <label class="col-md-4 col-form-label" for="example-password-input">Remarks<span class="requ">*</span></label>
                                                    <div class="">
                                                        <input type="text" class="form-control required" id="SP_Remarks" name="Remarks" placeholder="" autocomplete="off">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-md-5"></div>
                                            <div class="col-md-7" id="Reject_Evd_Submit_Div">
                                                <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Rej_Evd_Submit_Function()">
                                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                                </button>
                                            </div>
                                            <div class="col-md-7" id="Reject_Renewal_Submit_Div" style="display:none;">
                                                <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Rej_Renewal_Sub_Function()">
                                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                }
                                else
                                {
                                    <div class="col-6">
                                        <div class="row">
                                            <label for="" class="col-md-3 col-form-label">Work Completed?</label>

                                            <div class="col-md-2 col-form-label">
                                                <div id="ConfineYes" class="">
                                                    <label for="Yes"> <input id="Evidence_Btn" class="C_Renewal required" name="C_Renewal" type="radio" value="Evidence" />&nbsp;Yes </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2 col-form-label">
                                                <div id="ConfineNo" class="floatBlock">
                                                    <label for="No"> <input id="Renewal_Btn" checked class="C_Renewal required" name="C_Renewal" type="radio" value="Renewal" />&nbsp;No </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }
                        <div class="row" style="display:none;">
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Name<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Sp_Name" value="@LoginClass.First_Name" name="Sp_Name" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Designation<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Sp_Role" value="@LoginClass.Role_Name" name="Sp_Role" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Date and Time<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="date" class="form-control required" id="Sp_datetime" name="Sp_datetime" autocomplete="off">
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="row">
                            <div class="col-lg-5"></div>
                            <div class="col-lg-7" id="Evd_Submit_Div" style="display:none;">
                                <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Evd_Submit_Function()">
                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                </button>
                            </div>
                            <div class="col-lg-7" id="Renewal_Submit_Div" style="display:none;">
                                <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Renewal_Sub_Function()">
                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                </button>
                            </div>
                        </div>

                    }
                }

                @if (Model!.Status == "HSE Staff/HSE Team Approved" || Model!.Status == "Zone Supervisor Verified,Renewal Approved")
                {
                    @if (LoginClass.Role_Id == "16")
                    {
                        <form id="Form_Sp_Evidence" action="" method="post" class="row NotValid" novalidate="novalidate" enctype="multipart/form-data">
                            @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                            {
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="mt-xl-0 mt-4">
                                            <div class="accordion" id="AccordionRenewal">
                                                <div class="accordion-item">
                                                    <h2 class="accordion-header" id="headingTwo">
                                                        <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                            Renewal List
                                                        </button>
                                                    </h2>
                                                    <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                        <div class="accordion-body">
                                                            <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Competent Person</th>
                                                                        <th>Renewal From Date</th>
                                                                        <th>Renewal To Date</th>
                                                                        <th>Remarks</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="GettblConfineHistory">
                                                                    @foreach (var item in Model._Get_Renewal_Details)
                                                                    {

                                                                        <tr class="clstr">
                                                                            <td align="left" valign="middle">@item.Competent_Person</td>
                                                                            <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                            <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                            @if (@item.Remarks != null)
                                                                            {
                                                                                <td align="left" valign="middle">@item.Remarks</td>
                                                                            }
                                                                            else
                                                                            {
                                                                                <td align="left" valign="middle">----</td>
                                                                            }

                                                                        </tr>
                                                                    }
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <br />
                            }
                            <br />
                            <br />
                            @* <h4>Work Completion</h4>*@
                            <div class="col-6">
                                <div class="row">
                                    <label for="" class="col-md-3 col-form-label">Work Completed?</label>
                                    <div class="col-md-2 col-form-label">
                                        <div id="ConfineYes" class="">
                                            <label for="Yes"> <input id="Evidence_Btn" class="C_Renewal required" name="C_Renewal" type="radio" value="Evidence" />&nbsp;Yes </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2 col-form-label">
                                        <div id="ConfineNo" class="floatBlock">
                                            <label for="No"> <input id="Renewal_Btn" class="C_Renewal required" name="C_Renewal" type="radio" value="Renewal" />&nbsp;No </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @* <div class="row">
                    <label for="" class="col-md-5 col-form-label">Work Completed?</label>
                    <div class="col-md-2 col-form-label">
                    <div>
                    <label for="Yes"> <input id="Evidence_Btn" class="C_Renewal required" name="C_Renewal" type="radio" value="Evidence" />&nbsp;Yes </label>
                    </div>
                    </div>
                    <div class="col-md-2 col-form-label">
                    <div>
                    <label for="No"> <input id="Renewal_Btn" class="C_Renewal required" name="C_Renewal" type="radio" value="Renewal" />&nbsp;No </label>
                    </div>
                    </div>
                    </div>*@
                            <div class="row" id="Renewal_date_Div" style="display:none;">
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-10 col-form-label" for="example-password-input">Competent Person <span class="requ">*</span></label>
                                        <div class="">
                                            <input type="text" readonly class="form-control required" value="@Model.Competent_Person_Name" id="Ren_Competent_Person" name="Ren_Competent_Person" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                                        <div class="">
                                            <input type="date" class="form-control required" id="SP_From_Date" name="SP_From_Date" placeholder="">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                                        <div class="">
                                            <input type="date" class="form-control required" id="SP_To_Date" name="SP_To_Date" placeholder="">
                                        </div>
                                    </div>
                                </div>

                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Remarks<span class="requ">*</span></label>
                                        <div class="">
                                            <input type="text" class="form-control required" id="SP_Remarks" name="Remarks" placeholder="" autocomplete="off">
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="row" id="Renewal_Upload_Div" style="display:none;">

                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person <span class="requ">*</span></label>
                                            <div class="">
                                                <input type="text" readonly class="form-control required" value="@Model.Competent_Person_Name" id="Competent_Person" name="Competent_Person" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended<span class="requ">*</span></label>
                                            <div class="">
                                                <input type="date" class="form-control required" id="C_Complete_Date" name="C_Complete_Date">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return<span class="requ">*</span></label>
                                            <div class="">
                                                <input type="date" class="form-control required" id="C_Return_Date" name="C_Return_Date">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Upload <span class="requ">*</span></label>
                                            <div class="">
                                                <input id="Renewal_Files" name="Renewal_Files" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Renewal_File_Upload('Renewal_Files','UploadEvidence')" />
                                                <input type="hidden" class="UploadEvidence">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-lg-10"> <h4 class="card-title">Add Closure Details</h4></div>
                                    <div class="col-lg-2">
                                        <button type="button" id="btn_add" class="btn btn-success waves-effect waves-light" style="float: right;" onclick="FnAddToolsDetails()"><i class="mdi mdi-plus me-1"></i> Add</button>
                                    </div>
                                </div>
                                <br />
                                <br />
                                <hr />

                                <table id="tblToolsList" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        <tr>
                                            <td>
                                                <div class="form-group">
                                                    <input type="text" class="form-control Tools_Name required" id="Tools_Name" name="Tools_Name" autocomplete="off">
                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <input id="Closure_Files" name="Closure_Files" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Closure_File_Upload('Closure_Files','UploadEvidence_Closure')" />
                                                    <input type="hidden" class="UploadEvidence_Closure" />
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            @* <h4>Details Added By</h4>*@

                            <div class="row" style="display:none;">
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Name<span class="requ">*</span></label>
                                        <div class="">
                                            <input type="text" readonly class="form-control" id="Sp_Name" value="@LoginClass.First_Name" name="Sp_Name" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Designation<span class="requ">*</span></label>
                                        <div class="">
                                            <input type="text" readonly class="form-control" id="Sp_Role" value="@LoginClass.Role_Name" name="Sp_Role" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Date and Time<span class="requ">*</span></label>
                                        <div class="">
                                            <input type="date" class="form-control required" id="Sp_datetime" name="Sp_datetime" autocomplete="off">
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="row">
                                <div class="col-lg-5"></div>
                                <div class="col-lg-7" id="Evd_Submit_Div" style="display:none;">
                                    <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Evd_Submit_Function()">
                                        <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                    </button>
                                </div>
                                <div class="col-lg-7" id="Renewal_Submit_Div" style="display:none;">
                                    <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Renewal_Sub_Function()">
                                        <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                    </button>
                                </div>
                            </div>
                        </form>
                    }
                    else
                    {
                        @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="AccordionRenewal">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        Renewal List
                                                    </button>
                                                </h2>
                                                <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Competent Person</th>
                                                                    <th>Renewal From Date</th>
                                                                    <th>Renewal To Date</th>
                                                                    <th>Remarks</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Get_Renewal_Details)
                                                                {

                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Competent_Person</td>
                                                                        <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                        <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                        @if (@item.Remarks != null)
                                                                        {
                                                                            <td align="left" valign="middle">@item.Remarks</td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td align="left" valign="middle">----</td>
                                                                        }

                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br />
                        }
                        <br />
                        @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                <h4>Work Completion</h4>
                                if (item.Action_Radio_Btn == "Renewal")
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" readonly class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="text" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                    </div>
                                }
                                else
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" readonly class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-6 col-form-label" for="example-password-input">Image/Document Uploaded</label>
                                                <div class="">
                                                    @if (item._Add_Renewal_Evidences != null)
                                                    {
                                                        @foreach (var file in item._Add_Renewal_Evidences)
                                                        {
                                                            <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                        }
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                            <div class="">
                                                <input type="text" class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                            <div class="">
                                                <input type="date" class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                            <div class="">
                                                <input type="date" class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        @if (item._Add_Personnel_Tools != null)
                                        {
                                            @foreach (var obj in item._Add_Personnel_Tools!)
                                            {
                                                <tr>
                                                    <td>
                                                        <label>@obj.Personnel_Tools_Name</label>
                                                    </td>
                                                    <td>
                                                        @{
                                                            @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                            {
                                                                @foreach (var tools in obj!._Closure_Evidences!)
                                                                {
                                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                                }
                                                            }

                                                        }
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                                <h4>Details Added By</h4>

                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Role" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="" name="" value="@item.Date_Time">
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            }
                        }
                    }
                }

                @if (Model!.Status == "Renewal Approval Pending")
                {
                    @if (LoginClass.Role_Id == "5")
                    {
                        <div class="row" style="display:none;">
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Renewal_Zone_Approver" value="@LoginClass.First_Name" name="" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Renewal_Zone_Designation" value="@LoginClass.Role_Name" name="" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                    <div class="">
                                        <input type="date" readonly class="form-control required" id="Renewal_Zone_Datetime" name="" value="">
                                    </div>
                                </div>
                            </div>

                        </div>

                        @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="AccordionRenewal">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        Renewal List
                                                    </button>
                                                </h2>
                                                <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Competent Person</th>
                                                                    <th>Renewal From Date</th>
                                                                    <th>Renewal To Date</th>
                                                                    <th>Remarks</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Get_Renewal_Details)
                                                                {

                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Competent_Person</td>
                                                                        <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                        <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                        @if (@item.Remarks != null)
                                                                        {
                                                                            <td align="left" valign="middle">@item.Remarks</td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td align="left" valign="middle">----</td>
                                                                        }

                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }

                        <br />
                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label class="col-form-label" for="Email_Id">Approval Comments<span class="requ">*</span></label>
                                    <textarea class="form-control" id="Csp_Renewal_Zone_Comm" name="Csp_Renewal_Zone_Comm"></textarea>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-md-5"></div>
                            <div class="col-md-7">
                                <button type="button" class="btn btn-success waves-effect waves-light Zone_Details_Approve" onclick="Func_Zone_Renewal_Approve()">
                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Approve
                                </button>
                                <button class="btn btn-danger waves-effect waves-light Zone_Details_Reject" type="button" data-bs-toggle="modal" data-bs-target=".Zone_Renewal_Reject">
                                    Reject <i class="bx bx-list-plus"></i>
                                </button>
                            </div>
                        </div>

                        <div class="modal fade Zone_Renewal_Reject" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-lg modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="myExtraLargeModalLabel">Reject Confined Space</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div style="display:none;">
                                                <div class="form-group">
                                                    <input class="form-control" name="ZoneRenewalRejectId" id="ZoneRenewalRejectId" value="0">
                                                    <input class="form-control" name="Zone_Renewal_Rej_by" id="Zone_Renewal_Rej_by" value="">
                                                </div>
                                            </div>

                                            <div class="col-md-12">
                                                <div class="col-md-12">
                                                    <label for="example-search-input" class="form-model" style="color:black;">Reason For Reject</label>
                                                    <textarea class="form-control" rows="1" cols="40" style="height: 150px;" id="Renewal_Reject_Txt" name="Renewal_Reject_Txt" required minlen="1"></textarea>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="">
                                            <div style="text-align:center;">
                                                <button type="submit" class="btn btn-success" onclick="Func_Zone_Renewal_Reject()"> Submit</button>
                                            </div>
                                        </div>

                                    </div>
                                </div><!-- /.modal-content -->
                            </div><!-- /.modal-dialog -->
                        </div>

                    }
                    else
                    {
                        @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="AccordionRenewal">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        Renewal List
                                                    </button>
                                                </h2>
                                                <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Competent Person</th>
                                                                    <th>Renewal From Date</th>
                                                                    <th>Renewal To Date</th>
                                                                    <th>Remarks</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Get_Renewal_Details)
                                                                {

                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Competent_Person</td>
                                                                        <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                        <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                        @if (@item.Remarks != null)
                                                                        {
                                                                            <td align="left" valign="middle">@item.Remarks</td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td align="left" valign="middle">----</td>
                                                                        }

                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                }

                @if (Model!.Status == "Zone Supervisor Rejected the Renewal")
                {
                    @if (LoginClass.Role_Id == "16")
                    {
                        @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                        {
                            <div class="row">
                                <div class="col-xl-12">
                                    <div class="mt-xl-0 mt-4">
                                        <div class="accordion" id="AccordionRenewal">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                        Renewal List
                                                    </button>
                                                </h2>
                                                <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                    <div class="accordion-body">
                                                        <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Competent Person</th>
                                                                    <th>Renewal From Date</th>
                                                                    <th>Renewal To Date</th>
                                                                    <th>Remarks</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblConfineHistory">
                                                                @foreach (var item in Model._Get_Renewal_Details)
                                                                {

                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Competent_Person</td>
                                                                        <td align="left" valign="middle">@item.Renewal_From_Date</td>
                                                                        <td align="left" valign="middle">@item.Renewal_To_Date</td>
                                                                        @if (@item.Remarks != null)
                                                                        {
                                                                            <td align="left" valign="middle">@item.Remarks</td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td align="left" valign="middle">----</td>
                                                                        }

                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <br />
                        }
                        <br />
                        <div class="col-6">
                            <div class="row">
                                <label for="" class="col-md-3 col-form-label">Work Completed?</label>
                                <div class="col-md-2 col-form-label">
                                    <div id="ConfineYes" class="">
                                        <label for="Yes"> <input id="Evidence_Btn" disabled class="C_Renewal required" name="C_Renewal" type="radio" value="Evidence" />&nbsp;Yes </label>
                                    </div>
                                </div>
                                <div class="col-md-2 col-form-label">
                                    <div id="ConfineNo" class="floatBlock">
                                        <label for="No"> <input id="Renewal_Btn" checked class="C_Renewal required" name="C_Renewal" type="radio" value="Renewal" />&nbsp;No </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row" id="Renewal_date_Div">
                            <div class="col-3">
                                <div class="">
                                    <label class="col-md-10 col-form-label" for="example-password-input">Competent Person <span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" readonly class="form-control required" value="@Model.Competent_Person_Name" id="Ren_Competent_Person" name="Ren_Competent_Person" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                                    <div class="">
                                        <input type="date" class="form-control required" id="Rej_Renewal_SP_From_Date" name="SP_From_Date" placeholder="">
                                    </div>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                                    <div class="">
                                        <input type="date" class="form-control required" id="Rej_Renewal_SP_To_Date" name="SP_To_Date" placeholder="">
                                    </div>
                                </div>
                            </div>

                            <div class="col-3">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Remarks<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" class="form-control required" id="Rej_Renewal_SP_Remarks" name="Remarks" placeholder="" autocomplete="off">
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="row" style="display:none;">
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Name<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Rej_Renewal_Sp_Name" value="@LoginClass.First_Name" name="Rej_Renewal_Sp_Name" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Designation<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="text" readonly class="form-control" id="Rej_Renewal_Sp_Role" value="@LoginClass.Role_Name" name="Rej_Renewal_Sp_Role" autocomplete="off">
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="">
                                    <label class="col-md-4 col-form-label" for="example-password-input">Date and Time<span class="requ">*</span></label>
                                    <div class="">
                                        <input type="date" class="form-control required" id="Rej_Renewal_Sp_datetime" name="Rej_Renewal_Sp_datetime" autocomplete="off">
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="row">
                            <div class="col-lg-5"></div>
                            <div class="col-lg-7" id="Renewal_Submit_Div">
                                <button type="button" class="btn btn-success waves-effect waves-light submit" onclick="Rej_Renewal_Sub_Function()">
                                    <i class="bx bx-check-double font-size-16 align-middle me-2"></i>Submit
                                </button>
                            </div>
                        </div>
                    }
                }

                @if (Model!.Status == "Sp uploaded,Waiting for Zone Supervisor Approval")
                {
                    @if (LoginClass.Role_Id == "5")
                    {
                        @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                @*<h4>Work Completion</h4>*@
                                if (item.Action_Radio_Btn == "Renewal")
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                    </div>
                                }
                                else
                                {
                                    <div class="row" style="display:none;">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                }
                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Uploaded <span class="requ">*</span></label>
                                            <div class="">
                                                @if (item._Add_Renewal_Evidences != null)
                                                {
                                                    @foreach (var file in item._Add_Renewal_Evidences)
                                                    {
                                                        <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        @if (item._Add_Personnel_Tools != null)
                                        {
                                            @foreach (var obj in item._Add_Personnel_Tools!)
                                            {
                                                <tr>
                                                    <td>
                                                        <label>@obj.Personnel_Tools_Name</label>
                                                    </td>
                                                    <td>
                                                        @{
                                                            @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                            {
                                                                @foreach (var tools in obj!._Closure_Evidences!)
                                                                {
                                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                                }
                                                            }
                                                        }
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                                <h4>Details Added By</h4>

                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Role" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="" name="" value="@item.Date_Time">
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="row" style="display:none;">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="CSP_Evd_Zone_Approver" value="@LoginClass.First_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="CSP_Evd_Zone_Designation" value="@LoginClass.Designation_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="CSP_Evd_Zone_Datetime" name="CSP_Evd_Zone_Datetime">
                                            </div>
                                        </div>
                                    </div>

                                </div>


                                @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-xl-12">
                                            <div class="mt-xl-0 mt-4">
                                                <div class="accordion" id="AccordionRenewal">
                                                    <div class="accordion-item">
                                                        <h2 class="accordion-header" id="headingTwo">
                                                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                                Renewal List
                                                            </button>
                                                        </h2>
                                                        <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                            <div class="accordion-body">
                                                                <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Competent Person</th>
                                                                            <th>Renewal From Date</th>
                                                                            <th>Renewal To Date</th>
                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="GettblConfineHistory">
                                                                        @foreach (var Renewal in Model._Get_Renewal_Details)
                                                                        {

                                                                            <tr class="clstr">
                                                                                <td align="left" valign="middle">@Renewal.Competent_Person</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_From_Date</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_To_Date</td>
                                                                                @if (@Renewal.Remarks != null)
                                                                                {
                                                                                    <td align="left" valign="middle">@Renewal.Remarks</td>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <td align="left" valign="middle">----</td>
                                                                                }

                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }

                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="mb-3">
                                            <label class="col-form-label" for="Email_Id">Approval Comments<span class="requ">*</span></label>
                                            <textarea class="form-control" id="Csp_Evd_Zone_Comm" name="Csp_Evd_Zone_Comm"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-5"></div>
                                    <div class="col-md-7">
                                        <button type="button" class="btn btn-success waves-effect waves-light Zone_Details_Approve" onclick="Func_Zone_Details_Approve()">
                                            <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Approve
                                        </button>
                                        <button class="btn btn-danger waves-effect waves-light Zone_Details_Reject" type="button" data-bs-toggle="modal" data-bs-target=".Evid_Zone_reject">
                                            Reject <i class="bx bx-list-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="modal fade Evid_Zone_reject" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-lg modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="myExtraLargeModalLabel">Reject Confined Space</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="row">
                                                    <div style="display:none;">
                                                        <div class="form-group">
                                                            <input class="form-control" name="Evd_Reject_Id" id="Evd_Reject_Id" value="0">
                                                        </div>
                                                    </div>

                                                    <div class="col-md-12">
                                                        <div class="col-md-12">
                                                            <label for="example-search-input" class="form-model" style="color:black;">Reason For Reject</label>
                                                            <textarea class="form-control" rows="1" cols="40" style="height: 150px;" id="Evd_Reject_Reason" name="Evd_Reject_Reason" required minlen="1"></textarea>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="">
                                                    <div style="text-align:center;">
                                                        <button type="submit" class="btn btn-success" onclick="Btn_Reject_Upload_Evd()"> Submit</button>
                                                    </div>
                                                </div>

                                            </div>
                                        </div><!-- /.modal-content -->
                                    </div><!-- /.modal-dialog -->
                                </div>


                            }


                        }
                    }
                    else
                    {
                        @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                @*<h4>Work Completion</h4>*@
                                if (item.Action_Radio_Btn == "Renewal")
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                    </div>
                                }
                                else
                                {

                                    <div class="row" style="display:none;">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Uploaded <span class="requ">*</span></label>
                                            <div class="">
                                                @if (item._Add_Renewal_Evidences != null)
                                                {
                                                    @foreach (var file in item._Add_Renewal_Evidences)
                                                    {
                                                        <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        @if (item._Add_Personnel_Tools != null)
                                        {
                                            @foreach (var obj in item._Add_Personnel_Tools!)
                                            {
                                                <tr>
                                                    <td>
                                                        <label>@obj.Personnel_Tools_Name</label>
                                                    </td>
                                                    <td>
                                                        @{
                                                            @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                            {
                                                                @foreach (var tools in obj!._Closure_Evidences!)
                                                                {
                                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                                }
                                                            }
                                                        }
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                                <h4>Details Added By</h4>

                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Role" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="" name="" value="@item.Date_Time">
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-xl-12">
                                            <div class="mt-xl-0 mt-4">
                                                <div class="accordion" id="AccordionRenewal">
                                                    <div class="accordion-item">
                                                        <h2 class="accordion-header" id="headingTwo">
                                                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                                Renewal List
                                                            </button>
                                                        </h2>
                                                        <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                            <div class="accordion-body">
                                                                <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Competent Person</th>
                                                                            <th>Renewal From Date</th>
                                                                            <th>Renewal To Date</th>
                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="GettblConfineHistory">
                                                                        @foreach (var Renewal in Model._Get_Renewal_Details)
                                                                        {

                                                                            <tr class="clstr">
                                                                                <td align="left" valign="middle">@Renewal.Competent_Person</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_From_Date</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_To_Date</td>
                                                                                @if (@Renewal.Remarks != null)
                                                                                {
                                                                                    <td align="left" valign="middle">@Renewal.Remarks</td>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <td align="left" valign="middle">----</td>
                                                                                }

                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }

                    }
                }

                @if (Model!.Status == "Waiting for HSE Staff/HSE Team Approval")
                {
                    @if (LoginClass.Role_Id == "9" || LoginClass.Role_Id == "10" || LoginClass.Role_Id == "11")
                    {
                        @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                @*<h4>Work Completion</h4>*@
                                if (item.Action_Radio_Btn == "Renewal")
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                    </div>
                                }
                                else
                                {
                                    <div class="row" style="display:none;">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                }
                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Uploaded <span class="requ">*</span></label>
                                            <div class="">
                                                @if (item._Add_Renewal_Evidences != null)
                                                {
                                                    @foreach (var file in item._Add_Renewal_Evidences)
                                                    {
                                                        <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        @if (item._Add_Personnel_Tools != null)
                                        {
                                            @foreach (var obj in item._Add_Personnel_Tools!)
                                            {
                                                <tr>
                                                    <td>
                                                        <label>@obj.Personnel_Tools_Name</label>
                                                    </td>
                                                    <td>
                                                        @{
                                                            @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                            {
                                                                @foreach (var tools in obj!._Closure_Evidences!)
                                                                {
                                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                                }
                                                            }
                                                        }
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                                <h4>Details Added By</h4>

                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="HSE_Evd_Zone_Approver" value="@LoginClass.First_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="HSE_Evd_Zone_Designation" value="@LoginClass.Designation_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="HSE_Evd_Zone_Datetime" name="" value="@item.Date_Time">
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-xl-12">
                                            <div class="mt-xl-0 mt-4">
                                                <div class="accordion" id="AccordionRenewal">
                                                    <div class="accordion-item">
                                                        <h2 class="accordion-header" id="headingTwo">
                                                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                                Renewal List
                                                            </button>
                                                        </h2>
                                                        <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                            <div class="accordion-body">
                                                                <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Competent Person</th>
                                                                            <th>Renewal From Date</th>
                                                                            <th>Renewal To Date</th>
                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="GettblConfineHistory">
                                                                        @foreach (var Renewal in Model._Get_Renewal_Details)
                                                                        {

                                                                            <tr class="clstr">
                                                                                <td align="left" valign="middle">@Renewal.Competent_Person</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_From_Date</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_To_Date</td>
                                                                                @if (@Renewal.Remarks != null)
                                                                                {
                                                                                    <td align="left" valign="middle">@Renewal.Remarks</td>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <td align="left" valign="middle">----</td>
                                                                                }

                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <div class="row" style="display:none;">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="CSP_Evd_HSE_Approver" value="@LoginClass.First_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="CSP_Evd_HSE_Designation" value="@LoginClass.Designation_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="CSP_Evd_HSE_Datetime" name="CSP_Evd_HSE_Datetime">
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="mb-3">
                                            <label class="col-form-label" for="Email_Id">Approval Comments<span class="requ">*</span></label>
                                            <textarea class="form-control" id="Csp_Evd_Hse_Comm" name="Csp_Evd_Hse_Comm"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-5"></div>
                                    <div class="col-md-7">
                                        <button type="button" class="btn btn-success waves-effect waves-light Zone_Details_Approve" onclick="Func_HSE_Team_Details_Approve()">
                                            <i class="bx bx-check-double font-size-16 align-middle me-2"></i> Approve
                                        </button>
                                        <button class="btn btn-danger waves-effect waves-light Zone_Details_Reject" type="button" data-bs-toggle="modal" data-bs-target=".Evid_Hse_Staff_reject">
                                            Reject <i class="bx bx-list-plus"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="modal fade Evid_Hse_Staff_reject" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-lg modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="myExtraLargeModalLabel">Reject Confined Space</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="row">
                                                    <div style="display:none;">
                                                        <div class="form-group">
                                                            <input class="form-control" name="HSE_Evd_Reject_Id" id="HSE_Evd_Reject_Id" value="0">
                                                        </div>
                                                    </div>

                                                    <div class="col-md-12">
                                                        <div class="col-md-12">
                                                            <label for="example-search-input" class="form-model" style="color:black;">Reason For Reject</label>
                                                            <textarea class="form-control" rows="1" cols="40" style="height: 150px;" id="HSE_Evd_Reject_Reason" name="HSE_Evd_Reject_Reason" required minlen="1"></textarea>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="">
                                                    <div style="text-align:center;">
                                                        <button type="submit" class="btn btn-success" onclick="HSE_Btn_Reject_Evd()"> Submit</button>
                                                    </div>
                                                </div>

                                            </div>
                                        </div><!-- /.modal-content -->
                                    </div><!-- /.modal-dialog -->
                                </div>


                            }


                        }
                    }
                    else
                    {
                        @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                        {
                            foreach (var item in Model._Evidence_Details)
                            {
                                @*<h4>Work Completion</h4>*@
                                if (item.Action_Radio_Btn == "Renewal")
                                {
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                        @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                    </div>
                                }
                                else
                                {

                                    <div class="row" style="display:none;">
                                        <div class="col-4">
                                            <div class="">
                                                <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                                <div class="">
                                                    <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                                <h4>Work Completion Details</h4>
                                <div class="row">
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="">
                                            <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Uploaded <span class="requ">*</span></label>
                                            <div class="">
                                                @if (item._Add_Renewal_Evidences != null)
                                                {
                                                    @foreach (var file in item._Add_Renewal_Evidences)
                                                    {
                                                        <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                    }
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                            <th>Attachments</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GetToolsCount">
                                        @if (item._Add_Personnel_Tools != null)
                                        {
                                            @foreach (var obj in item._Add_Personnel_Tools!)
                                            {
                                                <tr>
                                                    <td>
                                                        <label>@obj.Personnel_Tools_Name</label>
                                                    </td>
                                                    <td>
                                                        @{
                                                            @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                            {
                                                                @foreach (var tools in obj!._Closure_Evidences!)
                                                                {
                                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                                }
                                                            }
                                                        }
                                                    </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                                <h4>Details Added By</h4>

                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Name" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                            <div class="">
                                                <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Role" name="" autocomplete="off">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                            <div class="">
                                                <input type="date" readonly class="form-control required" id="" name="" value="@item.Date_Time">
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                                {
                                    <div class="row">
                                        <div class="col-xl-12">
                                            <div class="mt-xl-0 mt-4">
                                                <div class="accordion" id="AccordionRenewal">
                                                    <div class="accordion-item">
                                                        <h2 class="accordion-header" id="headingTwo">
                                                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                                Renewal List
                                                            </button>
                                                        </h2>
                                                        <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                            <div class="accordion-body">
                                                                <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Competent Person</th>
                                                                            <th>Renewal From Date</th>
                                                                            <th>Renewal To Date</th>
                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="GettblConfineHistory">
                                                                        @foreach (var Renewal in Model._Get_Renewal_Details)
                                                                        {

                                                                            <tr class="clstr">
                                                                                <td align="left" valign="middle">@Renewal.Competent_Person</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_From_Date</td>
                                                                                <td align="left" valign="middle">@Renewal.Renewal_To_Date</td>
                                                                                @if (@Renewal.Remarks != null)
                                                                                {
                                                                                    <td align="left" valign="middle">@Renewal.Remarks</td>
                                                                                }
                                                                                else
                                                                                {
                                                                                    <td align="left" valign="middle">----</td>
                                                                                }

                                                                            </tr>
                                                                        }
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            }
                        }

                    }
                }

                @if (Model!.Status == "Closed")
                {
                    @if (Model._Evidence_Details != null && Model._Evidence_Details.Count != 0)
                    {
                        foreach (var item in Model._Evidence_Details)
                        {
                            @*<h4>Work Completion</h4>*@
                            if (item.Action_Radio_Btn == "Renewal")
                            {
                                <div class="row">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                            <div class="">
                                                <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                            </div>
                                        </div>
                                    </div>
                                    @* <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">From Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" value="@item.Renewal_From_Date">
                    </div>
                    </div>
                    </div>
                    <div class="col-4">
                    <div class="">
                    <label class="col-md-4 col-form-label" for="example-password-input">To Date <span class="requ">*</span></label>
                    <div class="">
                    <input type="date" readonly class="form-control" id="" name="" placeholder="" value="@item.Renewal_To_Date">
                    </div>
                    </div>
                    </div>*@

                                </div>
                            }
                            else
                            {

                                <div class="row" style="display:none;">
                                    <div class="col-4">
                                        <div class="">
                                            <label class="col-md-4 col-form-label" for="example-password-input">Action Needed</label>
                                            <div class="">
                                                <input type="text" class="form-control" id="" name="" value="@item.Action_Radio_Btn">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                            <h4>Work Completion Details</h4>
                            <div class="row">
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-10 col-form-label" for="example-password-input">Competent Person</label>
                                        <div class="">
                                            <input type="text" readonly class="form-control" id="" name="" autocomplete="off" value="@item.Competent_Person">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-12 col-form-label" for="example-password-input">Date & Time Work Completed/Suspended</label>
                                        <div class="">
                                            <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Work_Comp">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-12 col-form-label" for="example-password-input">Time Work Area Checked For Safe Return</label>
                                        <div class="">
                                            <input type="date" readonly class="form-control" id="" name="" value="@item.Date_Time_Safe_Return">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="">
                                        <label class="col-md-8 col-form-label" for="example-password-input">Image/Document Uploaded</label>
                                        <div class="">
                                            @if (item._Add_Renewal_Evidences != null)
                                            {
                                                @foreach (var file in item._Add_Renewal_Evidences)
                                                {
                                                    <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@file.Evidence_File_Path" target="_blank"></a>

                                                }
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <table id="" class="table table-striped dt-responsive nowrap tblround table-sm" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>Closure Details(Gas Test Report,Completion Report,etc)</th>
                                        <th>Attachments</th>
                                    </tr>
                                </thead>
                                <tbody id="GetToolsCount">
                                    @if (item._Add_Personnel_Tools != null)
                                    {
                                        @foreach (var obj in item._Add_Personnel_Tools!)
                                        {
                                            <tr>
                                                <td>
                                                    <label>@obj.Personnel_Tools_Name</label>
                                                </td>
                                                <td>
                                                    @{
                                                        @if (obj!._Closure_Evidences != null && obj!._Closure_Evidences.Count > 0)
                                                        {
                                                            @foreach (var tools in obj!._Closure_Evidences!)
                                                            {
                                                                <a class="mdi mdi-file-pdf" style="color: red;font-size: 20px" href="@tools.Closure_File_Path" target="_blank"></a>
                                                            }
                                                        }
                                                    }
                                                </td>
                                            </tr>
                                        }

                                    }
                                </tbody>
                            </table>
                            <h4>Details Added By</h4>

                            <div class="row">
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Name</label>
                                        <div class="">
                                            <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Name" name="" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Designation</label>
                                        <div class="">
                                            <input type="text" readonly class="form-control" id="" value="@item.Service_Provider_Role" name="" autocomplete="off">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="">
                                        <label class="col-md-4 col-form-label" for="example-password-input">Date and Time</label>
                                        <div class="">
                                            <input type="date" readonly class="form-control required" id="" name="" value="@item.Date_Time">
                                        </div>
                                    </div>
                                </div>

                            </div>
                            @if (Model._Get_Renewal_Details != null && Model._Get_Renewal_Details.Count > 0)
                            {
                                <div class="row">
                                    <div class="col-xl-12">
                                        <div class="mt-xl-0 mt-4">
                                            <div class="accordion" id="AccordionRenewal">
                                                <div class="accordion-item">
                                                    <h2 class="accordion-header" id="headingTwo">
                                                        <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRenewal" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px">
                                                            Renewal List
                                                        </button>
                                                    </h2>
                                                    <div id="collapseRenewal" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#AccordionRenewal">
                                                        <div class="accordion-body">
                                                            <table id="tblConfineHistory" class="table table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                                <thead>
                                                                    <tr>
                                                                        <th>Competent Person</th>
                                                                        <th>Renewal From Date</th>
                                                                        <th>Renewal To Date</th>
                                                                        <th>Remarks</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="GettblConfineHistory">
                                                                    @foreach (var Renewal in Model._Get_Renewal_Details)
                                                                    {

                                                                        <tr class="clstr">
                                                                            <td align="left" valign="middle">@Renewal.Competent_Person</td>
                                                                            <td align="left" valign="middle">@Renewal.Renewal_From_Date</td>
                                                                            <td align="left" valign="middle">@Renewal.Renewal_To_Date</td>
                                                                            @if (@Renewal.Remarks != null)
                                                                            {
                                                                                <td align="left" valign="middle">@Renewal.Remarks</td>
                                                                            }
                                                                            else
                                                                            {
                                                                                <td align="left" valign="middle">----</td>
                                                                            }

                                                                        </tr>
                                                                    }
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            }
                        }
                    }

                }

            </div>
        </div>

    </div>
</div>

@*<script src="@Url.Content("~/assets/pages/datatables/jquery.min.js")"></script>
*@
<script src="~/assets/js/controlofworkvalidation/serversidedatatableconfined.js"></script>



<script>

    $(document).ready(function () {
        Load_Google_Maps();
        var now = new Date();
        var day = ("0" + now.getDate()).slice(-2);
        var month = ("0" + (now.getMonth() + 1)).slice(-2);
        var today = now.getFullYear() + "-" + (month) + "-" + (day);
        $('#Approve_Date').val(today);
        $("#Hse_Approve_Date").val(today);
        $("#Sp_datetime").val(today);
        $("#Renewal_Zone_Datetime").val(today);
        $("#Rej_Renewal_Sp_datetime").val(today);
        $("#HSE_Evd_Zone_Datetime").val(today);
        $("#CSP_Evd_Zone_Datetime").val(today);
        $("#CSP_Evd_HSE_Datetime").val(today);
        $('input[name="C_Renewal"]').on('click', function () {
            if ($(this).val() == 'Renewal') {
                $("#Renewal_date_Div").show();
                $("#Renewal_Upload_Div").hide();
                $("#Evd_Submit_Div").hide();
                $("#Renewal_Submit_Div").show();
            }
            else {
                $("#Renewal_date_Div").hide();
                $("#Renewal_Upload_Div").show();
                $("#Evd_Submit_Div").show();
                $("#Renewal_Submit_Div").hide();
            }
        });

        $('input[name="Edit_Renewal"]').on('click', function () {
            if ($(this).val() == 'Renewal') {
                $("#Edit_Renewal_date_Div").show();
                $("#Edit_Renewal_Upload_Div").hide();
                $("#Reject_Evd_Submit_Div").hide();
                $("#Reject_Renewal_Submit_Div").show();
            }
            else {
                $("#Edit_Renewal_date_Div").hide();
                $("#Edit_Renewal_Upload_Div").show();
                $("#Reject_Evd_Submit_Div").show();
                $("#Reject_Renewal_Submit_Div").hide();
            }
        });

        $("#tblToolsList").on("click", "#DataDeleteTools", function () {
            $(this).closest("tr").remove();
        });

        var chck_ren = $('#el').is(':checked');

    });

    data = 1;
    function FnAddToolsDetails() {
        var vartools_Name = "Tools_Name" + data;
        var varClosure_Files = "Closure_Files" + data;
        var varClosure_Upload = "UploadEvidence_Closure" + data;
        var markup = "";
        markup = '<tr><td><input type="text" class="form-control Tools_Name" id="' + vartools_Name + '" name="Tools_Name" autocomplete="off" required /></td><td><input id="' + varClosure_Files + '" name="' + varClosure_Files + '" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Closure_File_Upload(' + "'" + varClosure_Files + "'" + ',' + "'" + varClosure_Upload + "'" + ')" /><input type="hidden" class="UploadEvidence_Closure ' + varClosure_Upload + '" /></td><td><button class="btn btn-primary" id="DataDeleteTools" onclick="" value="Remove">Remove</button></td></tr>'
        $("#GetToolsCount").append(markup);
        data++;
    }

    datas = 1;
    function Edit_FnAddToolsDetails() {
        var vartools_Name = "Tools_Name" + datas;
        var varClosure_Files = "Closure_Files" + datas;
        var varClosure_Upload = "UploadEvidence_Closure" + datas;
        var markup = "";
        markup = '<tr><td><input type="text" class="form-control Tools_Name" id="' + vartools_Name + '" name="Tools_Name" autocomplete="off" required /></td><td><input id="' + varClosure_Files + '" name="' + varClosure_Files + '" type="file" accept=".pdf,.png,.jpg,.jpeg" multiple class="form-control required" onchange="Closure_File_Upload(' + "'" + varClosure_Files + "'" + ',' + "'" + varClosure_Upload + "'" + ')" /><input type="hidden" class="UploadEvidence_Closure ' + varClosure_Upload + '" /></td><td><button class="btn btn-primary" id="DataDeleteTools" onclick="" value="Remove">Remove</button></td></tr>'
        $("#Edit_GetToolsCount").append(markup);
        data++;
    }

    function Func_Hse_Approve() {
        var varApprove_Txt = $("#Csp_Req_Hse_Comm").val();
        if (varApprove_Txt == "" || varApprove_Txt == null) {
            toastr.error("Please Enter the Comments!", "Error");
            $("#Csp_Req_Hse_Comm").focus();
            return false;
        }
        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "4",
            Remarks: "HSE Team Approved",
            Approve_Comments: varApprove_Txt,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Approval_Btn() {

        var varApprove_Txt = $("#Csp_Req_Zone_Comm").val();
        if (varApprove_Txt == "" || varApprove_Txt == null) {
            toastr.error("Please Enter the Comments!", "Error");
            $("#Csp_Req_Hse_Comm").focus();
            return false;
        }
        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "2",
            Remarks: "HSE Team Approval Pending",
            Approve_Comments: varApprove_Txt,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Load_Google_Maps() {
        map_Hzurl = '/CommonMaster/_LoadGoogleMap';
        $("#viewmap").load(map_Hzurl);
    }

    function Renewal_File_Upload(inputId, UploadPhotoId, pdficon) {
        var input = document.getElementById(inputId);
        var files = input.files;
        var formData = new FormData();
        if (files.length <= 5) {
            for (var i = 0; i != files.length; i++) {
                formData.append("files", files[i]);
            }
            var _url = '@Url.Action("CSP_Sp_Evidence_Upload", "ControlOfWork")';
            $.ajax({
                url: _url,
                data: formData,
                processData: false,
                contentType: false,
                type: "POST",
                success: function (data) {
                    $("." + UploadPhotoId).val(data)
                }
            });
            $("." + pdficon).hide();
        }

        else {
            $("#" + inputId).val("");
            $("." + UploadPhotoId).val("");
            Swal.fire({
                position: 'top-end',
                icon: 'Error',
                title: 'Maximum Allowed 5 Files',
                showConfirmButton: false,
                timer: 1500
            });
        }
    }

    function Closure_File_Upload(inputId, UploadPhotoId, Cls_pdf_icon) {
        var input = document.getElementById(inputId);
        var files = input.files;
        var formData = new FormData();
        if (files.length <= 5) {
            for (var i = 0; i != files.length; i++) {
                formData.append("files", files[i]);
            }
            var _url = '@Url.Action("CSP_Sp_Evidence_Upload", "ControlOfWork")';
            $.ajax({
                url: _url,
                data: formData,
                processData: false,
                contentType: false,
                type: "POST",
                success: function (data) {
                    $("." + UploadPhotoId).val(data)
                }
            });
            $("." + Cls_pdf_icon).hide();
        }

        else {
            $("#" + inputId).val("");
            $("." + UploadPhotoId).val("");
            Swal.fire({
                position: 'top-end',
                icon: 'Error',
                title: 'Maximum Allowed 5 Files',
                showConfirmButton: false,
                timer: 1500
            });
        }
    }

    function Evd_Submit_Function() {
        let valid = $("#Form_Sp_Evidence").valid();
        if (!valid) {
            return false;
        }
        var Evidence_file_ARR = [];

        var Tools_ARR = [];
        var SP_History_ARR = [];
        var His_Data = {};

        var varRen_Evd_Btn = $("input[type='radio'].C_Renewal:checked").val();
        var varEvidence_file = $(".UploadEvidence").val();

        if ((varEvidence_file != "") && (varEvidence_file != undefined) && (varEvidence_file != null)) {
            var valNew = varEvidence_file.split(',');
            for (i = 0; i < valNew.length; i++) {
                var t = valNew[i].replace(/[\(\)\[\]{}'"]/g, "");
                var File_data = {};
                File_data.Evidence_File_Id = "0";
                File_data.CSP_Id = $("#V_Confined_ID").val();
                File_data.Evidence_File_Path = t;
                File_data.CreatedBy = $("#CreatedBy").val();
                Evidence_file_ARR.push(File_data);
            }
        }

        var varCompetent_Person = $("#Competent_Person").val();
        var varC_Complete_Date = $("#C_Complete_Date").val();
        var varC_Return_Date = $("#C_Return_Date").val();

        var varSp_Name = $("#Sp_Name").val();
        var varSp_Role = $("#Sp_Role").val();
        var varSp_Date = $("#Sp_datetime").val().replace("T", " ");

        $('#tblToolsList tbody > tr').each(function () {
            var Closure_file_ARR = [];
            var vartoolsname = $(this).closest('tr').find('.Tools_Name').val();
            var varclosure = $(this).closest('tr').find('.UploadEvidence_Closure').val();

            if ((varclosure != "") && (varclosure != undefined) && (varclosure != null)) {
                var valNew = varclosure.split(',');
                for (i = 0; i < valNew.length; i++) {
                    var t = valNew[i].replace(/[\(\)\[\]{}'"]/g, "");
                    var File_data = {};
                    File_data.Closure_File_Id = "0";
                    File_data.CSP_Pers_Tools_Id = "0";
                    File_data.CSP_Id = $("#V_Confined_ID").val();
                    File_data.Closure_File_Path = t;
                    File_data.CreatedBy = $("#CreatedBy").val();
                    Closure_file_ARR.push(File_data);
                }
            }
            var data = {};
            data.CSP_Id = $("#V_Confined_ID").val();
            data.CSP_Pers_Tools_Id = "0";
            data.Personnel_Tools_Name = vartoolsname;
    @*data.Personnel_Tools_Count = vartoolsvalue;*@
                data.CreatedBy = $("#CreatedBy").val();
            data._Closure_Evidences = Closure_file_ARR;
            Tools_ARR.push(data);
        });

        var Sp_His_Data = {};

        Sp_His_Data.CSP_Id = $("#V_Confined_ID").val(),
            Sp_His_Data.History_Id = $("#History_Id").val(),
            Sp_His_Data.Emp_Id = $("#Emp_Id").val(),
            Sp_His_Data.Role_Id = $("#Role_Id").val(),
            Sp_His_Data.Updated_DateTime = $("#His_Date_Time").val(),
            SP_History_ARR.push(Sp_His_Data);

        var obj = {
            CSP_Add_Id: "0",
            CSP_Id: $("#V_Confined_ID").val(),
            Action_Radio_Btn: varRen_Evd_Btn,
            Competent_Person: varCompetent_Person,
            Date_Time_Work_Comp: varC_Complete_Date,
            Date_Time_Safe_Return: varC_Return_Date,
            Service_Provider_Name: varSp_Name,
            Service_Provider_Role: varSp_Role,
            Date_Time: varSp_Date,
            _Add_Renewal_Evidences: Evidence_file_ARR,
            _Add_Personnel_Tools: Tools_ARR,
            _Sp_Ptw_History_List: SP_History_ARR,
        };

        $.ajax({
            url: "/ControlOfWork/Add_Sp_Additional_Details",
            type: "POST",
            cache: false,
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Added Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Rej_Evd_Submit_Function() {
        var subSno = 1;
    @*  let valid = $("#form_Edit_Evidence").valid();
            if (!valid) {
            return false;
            }*@
                                    var Evidence_file_ARR = [];
        var Tools_ARR = [];
        var SP_History_ARR = [];
        var His_Data = {};

        var varRen_Evd_Btn = $("input[type='radio'].Edit_Renewal:checked").val();
        var varEvidence_file = $(".UploadEvidence").val();
        var varEvidence_file_Pdf = $(".Comp_Evid_Pdf").val();

        if ((varEvidence_file != "") && (varEvidence_file != undefined) && (varEvidence_file != null)) {
            var valNew = varEvidence_file.split(',');
            for (i = 0; i < valNew.length; i++) {
                var t = valNew[i].replace(/[\(\)\[\]{}'"]/g, "");
                var File_data = {};
                File_data.Evidence_File_Id = "0";
                File_data.CSP_Add_Id = $("#CSPAddId").val();
                File_data.CSP_Id = $("#V_Confined_ID").val();
                File_data.Evidence_File_Path = t;
                File_data.CreatedBy = $("#CreatedBy").val();
                Evidence_file_ARR.push(File_data);
            }
        } else {
            if (varEvidence_file_Pdf != null) {
                $(".Comp_Evid_Pdf").each(function (i, e) {
                    var File_data = {};
                    File_data.Evidence_File_Id = "0";
                    File_data.CSP_Add_Id = $("#CSPAddId").val();
                    File_data.CSP_Id = $("#V_Confined_ID").val();
                    File_data.Evidence_File_Path = e.defaultValue;
                    File_data.CreatedBy = $("#CreatedBy").val();
                    Evidence_file_ARR.push(File_data);
                });
            }
        }


        var varCompetent_Person = $("#Competent_Person").val();
        var varC_Complete_Date = $("#C_Complete_Date").val();
        var varC_Return_Date = $("#C_Return_Date").val();

        var varSp_Name = $("#Sp_Name").val();
        var varSp_Role = $("#Sp_Role").val();
        var varSp_Date = $("#Sp_datetime").val().replace("T", " ");
        $('#tblToolsList tbody > tr').each(function () {
            var Closure_file_ARR = [];
            var vartoolsname = $(this).closest('tr').find('.Tools_Name').val();
            var varclosurepdf = $(this).closest('tr').find('.cls_Evd_files').val();
            var varclosure = $(this).closest('tr').find('.UploadEvidence_Closure').val();
            var varPers_tools_Id = $(this).closest('tr').find('.CSPPersToolsId').val();

            if ((varclosure != "") && (varclosure != undefined) && (varclosure != null)) {
                var valNew = varclosure.split(',');
                for (i = 0; i < valNew.length; i++) {
                    var t = valNew[i].replace(/[\(\)\[\]{}'"]/g, "");
                    var File_data = {};
                    File_data.Closure_File_Id = "0";
                    File_data.CSP_Pers_Tools_Id = "0";
                    File_data.CSP_Add_Id = $("#CSPAddId").val();
                    File_data.CSP_Id = $("#V_Confined_ID").val();
                    File_data.Closure_File_Path = t;
                    File_data.CreatedBy = $("#CreatedBy").val();
                    Closure_file_ARR.push(File_data);
                }
            }
            else {
                if (varclosurepdf != null) {
                    $(this).closest('tr').find('.cls_Evd_files').each(function (i, e) {
                        var File_data = {};
                        File_data.Closure_File_Id = "0";
                        File_data.CSP_Pers_Tools_Id = $(".Cls_File_Tools_Id").val();
                        File_data.CSP_Id = $("#V_Confined_ID").val();
                        File_data.CSP_Add_Id = $("#CSPAddId").val();
                        File_data.Closure_File_Path = e.defaultValue;
                        File_data.CreatedBy = $("#CreatedBy").val();
                        Closure_file_ARR.push(File_data);
                    });
                }
            }
            var data = {};
            data.CSP_Id = $("#V_Confined_ID").val();
            data.CSP_Add_Id = $("#CSPAddId").val();
            data.CSP_Pers_Tools_Id = varPers_tools_Id;
            data.Personnel_Tools_Name = vartoolsname;
            data.CreatedBy = $("#CreatedBy").val();
            data._Closure_Evidences = Closure_file_ARR;
            Tools_ARR.push(data);
            subSno++;
        });

        var Sp_His_Data = {};

        Sp_His_Data.CSP_Id = $("#V_Confined_ID").val(),
            Sp_His_Data.History_Id = $("#History_Id").val(),
            Sp_His_Data.Emp_Id = $("#Emp_Id").val(),
            Sp_His_Data.Role_Id = $("#Role_Id").val(),
            Sp_His_Data.Updated_DateTime = $("#His_Date_Time").val(),
            SP_History_ARR.push(Sp_His_Data);

        var obj = {
            CSP_Add_Id: $("#CSPAddId").val(),
            CSP_Id: $("#V_Confined_ID").val(),
            Action_Radio_Btn: varRen_Evd_Btn,
            Competent_Person: varCompetent_Person,
            Date_Time_Work_Comp: varC_Complete_Date,
            Date_Time_Safe_Return: varC_Return_Date,
            Service_Provider_Name: varSp_Name,
            Service_Provider_Role: varSp_Role,
            Date_Time: varSp_Date,
            _Add_Renewal_Evidences: Evidence_file_ARR,
            _Add_Personnel_Tools: Tools_ARR,
            _Sp_Ptw_History_List: SP_History_ARR,
        };

        $.ajax({
            url: "/ControlOfWork/Edit_Sp_Additional_Details",
            type: "POST",
            cache: false,
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Added Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })

    }

    function Renewal_Sub_Function() {
        var SP_History_ARR = [];
        let valid = $("#Form_Sp_Evidence").valid();
        if (!valid) {
            return false;
        }
        var varRen_Evd_Btn = $("input[type='radio'].C_Renewal:checked").val();
        var Varcomp_Person = $("#Ren_Competent_Person").val();
        var varC_From_Date = $("#SP_From_Date").val();
        var varC_To_Date = $("#SP_To_Date").val();
        var varRemarks = $("#SP_Remarks").val();
        var varSp_Name = $("#Sp_Name").val();
        var varSp_Role = $("#Sp_Role").val();
        var varSp_Date = $("#Sp_datetime").val().replace("T", " ");

        var Sp_His_Data = {};

        Sp_His_Data.CSP_Id = $("#V_Confined_ID").val(),
            Sp_His_Data.History_Id = $("#History_Id").val(),
            Sp_His_Data.Emp_Id = $("#Emp_Id").val(),
            Sp_His_Data.Role_Id = $("#Role_Id").val(),
            Sp_His_Data.Updated_DateTime = $("#His_Date_Time").val(),
            SP_History_ARR.push(Sp_His_Data);

        var obj = {
            CSP_Renewal_Id: "0",
            CSP_Id: $("#V_Confined_ID").val(),
            Action_Radio_Btn: varRen_Evd_Btn,
            Renewal_From_Date: varC_From_Date,
            Renewal_To_Date: varC_To_Date,
            Remarks: varRemarks,
            Competent_Person: Varcomp_Person,
            Service_Provider_Name: varSp_Name,
            Service_Provider_Role: varSp_Role,
            Service_DateTime: varSp_Date,
            Sp_Renewal_Ptw_History_List: SP_History_ARR,
        };

        $.ajax({
            url: "/ControlOfWork/Add_Sp_Renewal_Details",
            type: "POST",
            cache: false,
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Added Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Rej_Renewal_Sub_Function() {
        var SP_History_ARR = [];
    @*  let valid = $("#form_Edit_Evidence").valid();
            if (!valid) {
            return false;
            }*@
                                        var varRen_Evd_Btn = $("input[type='radio'].C_Renewal:checked").val();
        var Varcomp_Person = $("#Ren_Competent_Person").val();
        var varC_From_Date = $("#Rej_Renewal_SP_From_Date").val();
        var varC_To_Date = $("#Rej_Renewal_SP_To_Date").val();
        var varRemarks = $("#Rej_Renewal_SP_Remarks").val();
        var varSp_Name = $("#Rej_Renewal_Sp_Name").val();
        var varSp_Role = $("#Rej_Renewal_Sp_Role").val();
        var varSp_Date = $("#Rej_Renewal_Sp_datetime").val().replace("T", " ");

        var Sp_His_Data = {};

        Sp_His_Data.CSP_Id = $("#V_Confined_ID").val(),
            Sp_His_Data.History_Id = $("#History_Id").val(),
            Sp_His_Data.Emp_Id = $("#Emp_Id").val(),
            Sp_His_Data.Role_Id = $("#Role_Id").val(),
            Sp_His_Data.Updated_DateTime = $("#His_Date_Time").val(),
            SP_History_ARR.push(Sp_His_Data);

        var obj = {
            CSP_Renewal_Id: "0",
            CSP_Id: $("#V_Confined_ID").val(),
            Action_Radio_Btn: varRen_Evd_Btn,
            Renewal_From_Date: varC_From_Date,
            Renewal_To_Date: varC_To_Date,
            Remarks: varRemarks,
            Competent_Person: Varcomp_Person,
            Service_Provider_Name: varSp_Name,
            Service_Provider_Role: varSp_Role,
            Service_DateTime: varSp_Date,
            Sp_Renewal_Ptw_History_List: SP_History_ARR,
        };

        $.ajax({
            url: "/ControlOfWork/Edit_Sp_Renewal_Details",
            type: "POST",
            cache: false,
            data: JSON.stringify(obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Added Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Func_Zone_Details_Approve() {

        var varApprove_Txt = $("#Csp_Evd_Zone_Comm").val();
        if (varApprove_Txt == "" || varApprove_Txt == null) {
            toastr.error("Please Enter the Comments!", "Error");
            $("#Csp_Evd_Zone_Comm").focus();
            return false;
        }

        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "12",
            Remarks: "Waiting for HSE Staff/HSE Team Approval",
            Approve_Comments: varApprove_Txt,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Func_HSE_Details_Approve() {
        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "8",
            Remarks: "Closed",

        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Func_Zone_Renewal_Approve() {
        var varApprove_Txt = $("#Csp_Renewal_Zone_Comm").val();
        if (varApprove_Txt == "" || varApprove_Txt == null) {
            toastr.error("Please Enter the Comments!", "Error");
            $("#Csp_Renewal_Zone_Comm").focus();
            return false;
        }

        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "8",
            Remarks: "Zone Supervisor Verified,Renewal Approved",
            Approve_Comments: varApprove_Txt,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }

    function Func_HSE_Team_Details_Approve() {
        var varApprove_Txt = $("#Csp_Evd_Hse_Comm").val();
        if (varApprove_Txt == "" || varApprove_Txt == null) {
            toastr.error("Please Enter the Comments!", "Error");
            $("#Csp_Evd_Hse_Comm").focus();
            return false;
        }
        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "10",
            Remarks: "Closed",
            Approve_Comments: varApprove_Txt,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        })
    }
</script>
<script>
    $(function () {
        var dtToday = new Date();

        var month = dtToday.getMonth() + 1;
        var day = dtToday.getDate();
        var year = dtToday.getFullYear();

        if (month < 10)
            month = '0' + month.toString();
        if (day < 10)
            day = '0' + day.toString();

        var maxDate = year + '-' + month + '-' + day;
        $('#Approve_Date').attr('max', maxDate);
    });
    $(function () {
        var dtToday = new Date();

        var month = dtToday.getMonth() + 1;
        var day = dtToday.getDate();
        var year = dtToday.getFullYear();

        if (month < 10)
            month = '0' + month.toString();
        if (day < 10)
            day = '0' + day.toString();

        var maxDate = year + '-' + month + '-' + day;
        $('#Hse_Approve_Date').attr('max', maxDate);
    });

    function Btn_Reject_Confined_Request() {
        var varReject_CSP = $("#Reject_Reason_Description_Con").val();
        if (varReject_CSP == "" || varReject_CSP == null) {
            toastr.error("Please enter the reject reason!", "Error");
            $("#Reject_Reason_Description_Con").focus();
            return false;
        }
        var Reject_ARR = [];
        var Reject_Data = {};

        Reject_Data.CSP_Id = $("#V_Confined_ID").val(),
            Reject_Data.Zone_Reject_Id = $("#COW_Reject_Id").val(),
            Reject_Data.Remarks = $("#Reject_Reason_Description_Con").val(),
            Reject_Data.Zone_Approver_Name = $("#C_Approve_Name").val(),
            Reject_Data.Designation = $("#C_Designation").val(),
            Reject_Data.Date_Time = $("#Approve_Date").val(),
            Reject_Data.Status = "3",
            Reject_ARR.push(Reject_Data);

        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "3",
            Remarks: "Zone Supervisor Rejected",
            _Zone_HSE_Reject: Reject_ARR,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space_Reject",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        });
    }
    function Btn_Reject_Confined_Hse() {
        var varReject_HSE = $("#Reject_Reason_Description_Hse").val();
        if (varReject_HSE == "" || varReject_HSE == null) {
            toastr.error("Please enter the reject reason!", "Error");
            $("#Reject_Reason_Description_Hse").focus();
            return false;
        }
        var Reject_ARR = [];
        var Reject_Data = {};

        Reject_Data.CSP_Id = $("#V_Confined_ID").val(),
            Reject_Data.Zone_Reject_Id = $("#Hse_COW_Reject_Id").val(),
            Reject_Data.Remarks = $("#Reject_Reason_Description_Hse").val(),
            Reject_Data.Zone_Approver_Name = $("#C_Hse_Approver_Name").val(),
            Reject_Data.Designation = $("#C_Hse_Designation").val(),
            Reject_Data.Date_Time = $("#Hse_Approve_Date").val(),
            Reject_Data.Status = "5",
            Reject_ARR.push(Reject_Data);

        var Objt = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "5",
            Remarks: "HSE Team Rejected",
            _Zone_HSE_Reject: Reject_ARR,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space_Reject",
            type: "POST",
            cache: false,
            data: JSON.stringify(Objt),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        });
    }

    function Btn_Reject_Upload_Evd() {
        var varReject_Zone_Evd = $("#Evd_Reject_Reason").val();
        if (varReject_Zone_Evd == "" || varReject_Zone_Evd == null) {
            toastr.error("Please enter the reject reason!", "Error");
            $("#Evd_Reject_Reason").focus();
            return false;
        }
        var Reject_ARR = [];
        var Reject_Data = {};

        Reject_Data.CSP_Id = $("#V_Confined_ID").val(),
            Reject_Data.Zone_Reject_Id = $("#Evd_Reject_Id").val(),
            Reject_Data.Remarks = $("#Evd_Reject_Reason").val(),
            Reject_Data.Zone_Approver_Name = $("#CSP_Evd_Zone_Approver").val(),
            Reject_Data.Designation = $("#CSP_Evd_Zone_Designation").val(),
            Reject_Data.Date_Time = $("#Evd_Zone_Datetime").val(),
            Reject_Data.Status = "11",
            Reject_ARR.push(Reject_Data);

        var Objt = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "11",
            Remarks: "Zone Supervisor Rejected the Evidence",
            _Zone_HSE_Reject: Reject_ARR,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space_Reject",
            type: "POST",
            cache: false,
            data: JSON.stringify(Objt),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        });
    }

    function Func_Zone_Renewal_Reject() {
        var varReject_Zone_Renewal = $("#Renewal_Reject_Txt").val();
        if (varReject_Zone_Renewal == "" || varReject_Zone_Renewal == null) {
            toastr.error("Please enter the reject reason!", "Error");
            $("#Renewal_Reject_Txt").focus();
            return false;
        }
        var Reject_ARR = [];
        var Reject_Data = {};

        Reject_Data.CSP_Id = $("#V_Confined_ID").val(),
            Reject_Data.Zone_Reject_Id = $("#ZoneRenewalRejectId").val(),
            Reject_Data.Remarks = $("#Renewal_Reject_Txt").val(),
            Reject_Data.Zone_Approver_Name = $("#Renewal_Zone_Approver").val(),
            Reject_Data.Designation = $("#Renewal_Zone_Designation").val(),
            Reject_Data.Date_Time = $("#Renewal_Zone_Datetime").val(),
            Reject_Data.Status = "9",
            Reject_ARR.push(Reject_Data);

        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "9",
            Remarks: "Zone Supervisor Rejected the Renewal",
            _Zone_HSE_Reject: Reject_ARR,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space_Reject",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        });
    }

    function HSE_Btn_Reject_Evd() {
        var varReject_HSE_Evd = $("#HSE_Evd_Reject_Reason").val();
        if (varReject_HSE_Evd == "" || varReject_HSE_Evd == null) {
            toastr.error("Please enter the reject reason!", "Error");
            $("#HSE_Evd_Reject_Reason").focus();
            return false;
        }
        var Reject_ARR = [];
        var Reject_Data = {};

        Reject_Data.CSP_Id = $("#V_Confined_ID").val(),
            Reject_Data.Zone_Reject_Id = $("#HSE_Evd_Reject_Id").val(),
            Reject_Data.Remarks = $("#HSE_Evd_Reject_Reason").val(),
            Reject_Data.Zone_Approver_Name = $("#CSP_Evd_HSE_Approver").val(),
            Reject_Data.Designation = $("#CSP_Evd_HSE_Designation").val(),
            Reject_Data.Date_Time = $("#CSP_Evd_HSE_Datetime").val(),
            Reject_Data.Status = "13",
            Reject_ARR.push(Reject_Data);

        var Obj = {
            CSP_Id: $("#V_Confined_ID").val(),
            History_Id: $("#History_Id").val(),
            Emp_Id: $("#Emp_Id").val(),
            Role_Id: $("#Role_Id").val(),
            Updated_DateTime: $("#His_Date_Time").val(),
            Status: "13",
            Remarks: "HSE Staff/HSE Team Rejected the Evidence",
            _Zone_HSE_Reject: Reject_ARR,
        };
        $.ajax({
            url: "/ControlOfWork/Add_Zone_Confined_Space_Reject",
            type: "POST",
            cache: false,
            data: JSON.stringify(Obj),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                if (data == "200") {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'success',
                        title: 'Update Successfully',
                        showConfirmButton: false,
                        timer: 1500
                    }).then(function () {
                        window.location.reload();
                    });
                }
                else {
                    Swal.fire({
                        position: 'top-end',
                        icon: 'Error',
                        title: 'Error',
                        showConfirmButton: false,
                        timer: 1500
                    });
                }
            },
        });
    }
</script>

<script>
    // if HTML DOM Element that contains the map is found...

    if (document.getElementById('map-canvas_view')) {
        var content;

        var latitude = $("#Loc_Latitude").val();
        var longitude = $("#Loc_Longitude").val();

        var map;
        var marker;
        navigator.geolocation.getCurrentPosition(loadMap);

        function loadMap(location) {
            if (location.coords) {
                latitude = $("#Loc_Latitude").val();//location.coords.latitude;
                longitude = $("#Loc_Longitude").val();//location.coords.longitude;
            }

            // Coordinates to center the map
            var myLatlng = new google.maps.LatLng(latitude, longitude);

            // Other options for the map, pretty much selfexplanatory
            var mapOptions = {
                zoom: 12,
                center: myLatlng,//new google.maps.LatLng(latitude, longitude),
                mapTypeId: google.maps.MapTypeId.PLAN,
            };

            var image = '../assets/images/mappin.png';
            // Attach a map to the DOM Element, with the defined settings
            map = new google.maps.Map(document.getElementById("map-canvas_view"), mapOptions);

            content = document.getElementById('information');
            google.maps.event.addListener(map, 'click', function (e) {
                placeMarkerView(e.latLng);
                //alert(e.latLng);
            });
            marker = new google.maps.Marker({
                position: myLatlng,
                map: map,
                animation: google.maps.Animation.DROP,
                icon: image
            });
        }
    }
    function placeMarkerView(location) {
        marker.setPosition(location);
        map.setCenter(location)
        //content.innerHTML="";
        $("#Lat").val(location.lat());
        $("#Long").val(location.lng());
        content.innerHTML = "Lat: " + location.lat() + " / Long: " + location.lng();
        google.maps.event.addListener(marker, 'click', function (e) {
            new google.maps.InfoWindow({
                content: "Lat: " + location.lat() + " / Long: " + location.lng()
            }).open(map, marker);
        });
    }
</script>