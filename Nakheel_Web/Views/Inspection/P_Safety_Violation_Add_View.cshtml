@{
    Layout = null;
}
@using Microsoft.AspNetCore.Http;
@using Nakheel_Web.Models.AccountsMaster;
@using Newtonsoft.Json;
@using static Nakheel_Web.Authentication.Common;
@inject IHttpContextAccessor HttpContextAccessor;
@{
    var str = HttpContextAccessor.HttpContext!.Session.GetString("Login");
    string Des = Decrypt(str!);
    Login_ LoginClass = JsonConvert.DeserializeObject<Login_>(Des!)!;
}
@model Nakheel_Web.Models.InspectionMaster.M_Insp_Safety_Violation
<style>
    .error {
        color: red;
    }

    .image-container {
        position: relative;
    }

    .close-button {
        position: absolute;
        top: -12px;
        right: 53px;
        background-color: red;
        border: 1px solid #ccc;
        border-radius: 50%;
        cursor: pointer;
    }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.min.css" crossorigin="anonymous">
<link href="~/assets/libs/fileupload/fileinput.min.css" rel="stylesheet" />
<script src="~/assets/libs/fileupload/fileinput.min.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
<link href="~/assets/css/font-awesome.css" rel="stylesheet" />
<link href="~/assets/css/frmwiz.css" rel="stylesheet" />

@if (Model != null)
{
    <input type="hidden" id="Insp_Request_Id" value="@Model!.Insp_Request_Id" class="Insp_Request_Id" />
    <input type="hidden" id="Safety_Violation_Id" value="@Model!.Safety_Violation_Id" class="Safety_Violation_Id" />
    <input type="hidden" id="Zone_Id" value="@Model!.Zone_Id" class="Zone_Id" />
    <input type="hidden" id="Community_Id" value="@Model!.Community_Id" class="Community_Id" />
    if (Model.Status == "Safety Violation Pending")
    {
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <label style="margin-top: 10px;display: contents;" for="Yes"> <input required asp-for="Responsible_Dept" id="NCM_Staff" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="NCM_Staff" required>&nbsp;NCM Staff&nbsp;&nbsp;</label>
                            <label for="No"> <input required asp-for="Responsible_Dept" id="Service_provider" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="Service_provider" required>&nbsp;Service provider</label>
                        </td>
                    </tr>
                    <tr class="col-lg-4 Emp_Service_provider_Div" style="@(Model.Responsible_Dept == "Service_provider"?"display:block;":"display:none;")">
                        <td><b class="font-bold">Service provider</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <select style="width: 225px;" class="form-select Emp_Service_provider" asp-for="Emp_Service_provider" required name="Emp_Service_provider" id="Emp_Service_provider" asp-items="@(new SelectList(Model.Emp_Service_Provider_List,"Employee_Identity_Id","First_Name"))">
                                <option value="" disabled selected="selected">-- Select Service provider --</option>
                            </select>
                        </td>

                        <td></td>
                        <td></td>
                        <td></td>

                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <div class="row">
            <br />
            <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                <h5 class="card-title">&nbsp;&nbsp;Type Of Violation<span class="requ">*</span></h5>
            </div>
        </div>
        <div class="row">
            @if (Model.Insp_Spot_Category_Master_List != null)
            {
                @foreach (var item in Model.Insp_Spot_Category_Master_List)
                {
                    <div class="col-lg-2">
                        <div class="col-md-12">
                            <div class="form-check mb-12">
                                <input required class="form-check-input Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="@item.Value" id="Type_Violation_Mas_Id'@item.Value'">
                                <label class="form-check-label Type_Violation_Mas_Name" id="Type_Violation_Mas_Name'@item.Value'" for="Type_Violation_Mas_Name'@item.Value'">@item.Text</label>
                            </div>
                        </div>
                    </div>
                }
                <div class="col-lg-2">
                    <div class="col-md-12">
                        <div class="form-check mb-12">
                            <input onclick="Fn_Type_Violation_Others(this.value)" class="form-check-input Type_Violation_Other_Id Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="-1" id="Type_Violation_Other_Id">
                            <label class="form-check-label" for="Type_Violation_Mas_Name">Others</label>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3">
                    <textarea style="display:none;" id="Type_Violation_Others_Text" class="form-control form-control-sm Type_Violation_Others_Text Type_Violation_Others_Div" name="Type_Violation_Others_Text" rows="1"></textarea>
                </div>

                <label id="Type_Violation_Mas_Id" class="error text-danger" for="Type_Violation_Mas_Id"></label>
            }
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Description of Violation  <span class="requ">*</span>
                        </label>
                        &nbsp;&nbsp;<textarea required id="Description_Violation" class="form-control TextArea_Autoresizing Description_Violation" name="Description_Violation" rows="4"></textarea>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Requirement(s) <span class="requ">*</span>
                        </label>
                        <textarea id="Requirement" required class="form-control TextArea_Autoresizing Requirement" name="Requirement" rows="4"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-group col-md-12">
                        <label style="font-weight: 600;">Photos</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #c5c5c5">Note: Format : jpg, png, jpeg, bmp</span>
                        <div class="file-loading">
                            <input id="inputPhoto" name="files" type="file" accept="image/*" multiple>
                        </div>&nbsp;&nbsp;&nbsp;
                    </div>
                </div>
            </div>
        </div>
        <br />

        @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
        {
            <br />
            <div class="row">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                History of Approval
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Role</th>
                                            <th>Assigned/ Created Date</th>
                                            <th>Action Taken Date</th>
                                            <th>Prev.Status</th>
                                            <th>Cur.Status</th>
                                            <th>Next Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GettblIncidentHistory">
                                        @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                        {
                                            <tr class="clstr">
                                                <td align="left" valign="middle">@item.Emp_Name</td>
                                                <td align="left" valign="middle">@item.Role_Name</td>
                                                <td align="left" valign="middle">@item.Last_DateTime</td>
                                                <td align="left" valign="middle">@item.CreatedDate</td>
                                                <td align="left" valign="middle">@item.Status</td>
                                                <td align="left" valign="middle">@item.Remarks</td>
                                                <td align="left" valign="middle">@item.Next_Action</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        }
        <div class="AddSubmit_Div" id="AddSubmit_Div">
            <div style="text-align:center;">
                <button type="submit" class="btn btn-success Safe_btn_Submit btn_Submit" id="btn-save-event"> Submit</button>
            </div>
            <br />
        </div>
    }
    if (Model.Status == "HSE Manager Approval Pending")
    {
        if (Model.Safety_Violation_Reject_List != null)
        {
            @if (Model.Safety_Violation_Reject_List.Count > 0 && Model.Safety_Violation_Reject_List != null)
            {
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo_1" aria-expanded="false" aria-controls="collapseTwo_1" style="background: #00263a;color: white;height:30px;width:99%;">
                                    Reject List
                                </button>
                            </h2>
                            <div id="collapseTwo_1" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Reject ID</th>
                                                <th>Reject Reason</th>
                                                <th>Reject of Status</th>
                                                <th>Rejected By</th>
                                                <th>Created Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Safety_Violation_Reject_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Unique_Id</td>
                                                    <td align="left" valign="middle">@item.Reject_Reason</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.CreatedBy</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        }
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model!.Responsible_Dept == "Service_provider")
                            {
                                <label>Service provider</label>
                            }
                            else
                            {
                                <label>NCM Staff</label>
                            }

                        </td>
                    </tr>
                    <tr>

                        <td><b class="font-bold">Type Of Violation</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model.Safety_Violation_Sub_Type_List[0]!.Type_Master_Id == "-1")
                            {
                                <label>Others : @Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                            else
                            {
                                <label>@Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                        </td>

                        @if (@Model.Responsible_Dept == "Service_provider")
                        {
                            <td><b class="font-bold">Service provider</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Emp_Service_provider_Name</td>
                        }
                        else
                        {
                            <td></td>
                            <td></td>
                            <td></td>
                        }
                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Description of Violation</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Description_Violation</td>
                        </tr>
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Requirement(s)</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Requirement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Picture</b></td>
                            <td>:</td>
                            <td class="tdtxt">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        <a href="@item.File_Path" target="_blank">
                                            <img target="_blank" src="@item.File_Path" width="100" height="80" style="padding: 3px;">
                                        </a>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>


        @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
        {
            <br />
            <div class="row">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                History of Approval
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Role</th>
                                            <th>Assigned/ Created Date</th>
                                            <th>Action Taken Date</th>
                                            <th>Prev.Status</th>
                                            <th>Cur.Status</th>
                                            <th>Next Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GettblIncidentHistory">
                                        @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                        {
                                            <tr class="clstr">
                                                <td align="left" valign="middle">@item.Emp_Name</td>
                                                <td align="left" valign="middle">@item.Role_Name</td>
                                                <td align="left" valign="middle">@item.Last_DateTime</td>
                                                <td align="left" valign="middle">@item.CreatedDate</td>
                                                <td align="left" valign="middle">@item.Status</td>
                                                <td align="left" valign="middle">@item.Remarks</td>
                                                <td align="left" valign="middle">@item.Next_Action</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        }
        if (LoginClass.Role_Id == "10")
        {
            <div class="row col-lg-12">
                <div class="col-lg-6" style="text-align: right;">
                    <button data-bs-toggle="modal" data-bs-target=".add-Safe-Vio-Approve" type="button" style="background-color: green; border-color: green;" class="btn btn-success">
                        Approve
                    </button>
                </div>
                <div class="col-lg-6" style="text-align: left;">
                    <button onclick="Fn_SV_Rej()" data-bs-toggle="modal" data-bs-target=".add-Safe-Vio-Reject" type="button" class="btn btn-danger btn_Submit" id="btn-save-event"> Reject</button>
                </div>
            </div>
        }

    }
    if (Model.Status == "HSE Manager Rejected")
    {
        if (Model.Safety_Violation_Reject_List != null)
        {
            @if (Model.Safety_Violation_Reject_List.Count > 0 && Model.Safety_Violation_Reject_List != null)
            {
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo_1" aria-expanded="false" aria-controls="collapseTwo_1" style="background: #00263a;color: white;height:30px;width:99%;">
                                    Reject List
                                </button>
                            </h2>
                            <div id="collapseTwo_1" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Reject ID</th>
                                                <th>Reject Reason</th>
                                                <th>Reject of Status</th>
                                                <th>Rejected By</th>
                                                <th>Created Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Safety_Violation_Reject_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Unique_Id</td>
                                                    <td align="left" valign="middle">@item.Reject_Reason</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.CreatedBy</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        }

        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <label style="margin-top: 10px;display: contents;" for="Yes"> <input required asp-for="Responsible_Dept" id="NCM_Staff" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="NCM_Staff" required>&nbsp;NCM Staff&nbsp;&nbsp;</label>
                            <label for="No"> <input required asp-for="Responsible_Dept" id="Service_provider" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="Service_provider" required>&nbsp;Service provider</label>
                        </td>
                    </tr>
                    <tr class="Emp_Service_provider_Div" style="@(Model.Responsible_Dept == "Service_provider"?"":"display:none;")">
                        <td><b class="font-bold">Service provider</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <select class="form-select Emp_Service_provider" asp-for="Emp_Service_provider" required name="Emp_Service_provider" id="Emp_Service_provider" asp-items="@(new SelectList(Model.Emp_Service_Provider_List,"Employee_Identity_Id","First_Name"))">
                                <option value="" disabled selected="selected">-- Select Service provider --</option>
                            </select>
                        </td>

                        <td></td>
                        <td></td>
                        <td></td>

                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>


            <div class="row">
                <br />
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <h5 class="card-title">&nbsp;&nbsp;TYPE OF VIOLATION<span class="requ">*</span></h5>
                </div>
            </div>
            <div class="row">
                @if (Model.Insp_Spot_Category_Master_List != null)
                {
                    @foreach (var item in Model.Insp_Spot_Category_Master_List)
                    {
                        <div class="col-lg-2">
                            <div class="col-md-12">
                                <div class="form-check mb-12">
                                    <input checked="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id==item.Value)?true:false)" class="form-check-input Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="@item.Value" id="Type_Violation_Mas_Id'@item.Value'">
                                    <label class="form-check-label Type_Violation_Mas_Name" id="Type_Violation_Mas_Name'@item.Value'" for="Type_Violation_Mas_Name'@item.Value'">@item.Text</label>
                                </div>
                            </div>
                        </div>
                    }

                    <div class="col-lg-2">
                        <div class="col-md-12">
                            <div class="form-check mb-12">
                                <input checked="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id=="-1")?true:false)" onclick="Fn_Type_Violation_Others(this.value)" class="form-check-input Type_Violation_Other_Id Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="-1" id="Type_Violation_Other_Id">
                                <label class="form-check-label" for="Type_Violation_Mas_Name">Others</label>
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-3">
                        <textarea style="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id=="-1")?"display:block;":"display:none;")" id="Type_Violation_Others_Text" class="form-control form-control-sm Type_Violation_Others_Text Type_Violation_Others_Div" name="Type_Violation_Others_Text" rows="1">@(Model.Safety_Violation_Sub_Type_List!.Any(x => x.Type_Master_Id == "-1") ? Model.Safety_Violation_Sub_Type_List![0].Others_Name : "")</textarea>
                    </div>

                    <label id="Type_Violation_Mas_Id" class="error text-danger" for="Type_Violation_Mas_Id"></label>
                }
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Description of Violation  <span class="requ">*</span>
                        </label>
                        &nbsp;&nbsp;<textarea id="Description_Violation" class="form-control TextArea_Autoresizing Description_Violation" name="Description_Violation" rows="4">@Model.Description_Violation</textarea>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Requirement(s) <span class="requ">*</span>
                        </label>
                        <textarea id="Requirement" class="form-control TextArea_Autoresizing Requirement" name="Requirement" rows="4">@Model.Requirement</textarea>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:20%;"><b class="font-bold">Picture</b><br /><span style="color: #c5c5c5">Note: Format : jpg, png, jpeg, bmp</span></td>
                            <td>:</td>
                            <td class="tdtxt">
                                <input id="File_Safe_Picture" class="form-control File_Safe_Picture" onchange="Upload_Safe_Picture('File_Safe_Picture','Safe_UploadPicture')" type="file" accept=".png, .jpg, .jpeg, .bmp" style="width: 194px;" multiple>
                                <input type="hidden" value="" class="Safe_UploadPicture" name="Safe_UploadPicture" id="Safe_UploadPicture">
                            </td>
                        </tr>

                        <tr>
                            <td><b class="font-bold">Uploaded Pictures</b></td>
                            <td>:</td>
                            <td colspan="6">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    @foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        var Remove_Picture_Div = "Remove_Picture_Div" + item.Photo_Id;
                                        <span class="@Remove_Picture_Div">
                                            <a href="@item.File_Path" target="_blank">
                                                <img target="_blank" src="@item.File_Path" width="30" height="30">
                                            </a>
                                            <span style="color:red;cursor: pointer;" onclick="Fn_Safe_Photo_Delete(@item.Photo_Id)">Remove</span>
                                        </span>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>

                        </tr>

                    </tbody>
                </table>
            </div>
        </div>
        <br />
        @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
        {
            <br />
            <div class="row">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                History of Approval
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Role</th>
                                            <th>Assigned/ Created Date</th>
                                            <th>Action Taken Date</th>
                                            <th>Prev.Status</th>
                                            <th>Cur.Status</th>
                                            <th>Next Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GettblIncidentHistory">
                                        @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                        {
                                            <tr class="clstr">
                                                <td align="left" valign="middle">@item.Emp_Name</td>
                                                <td align="left" valign="middle">@item.Role_Name</td>
                                                <td align="left" valign="middle">@item.Last_DateTime</td>
                                                <td align="left" valign="middle">@item.CreatedDate</td>
                                                <td align="left" valign="middle">@item.Status</td>
                                                <td align="left" valign="middle">@item.Remarks</td>
                                                <td align="left" valign="middle">@item.Next_Action</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        }
        <div class="AddSubmit_Div" id="AddSubmit_Div">
            <div style="text-align:center;">
                <button type="submit" class="btn btn-success btn_Submit" id="btn-save-event"> Submit</button>
            </div>
            <br />
        </div>
    }
    if (Model.Status == "HSE Director Approval Pending")
    {
        if (Model.Safety_Violation_Reject_List != null)
        {
            @if (Model.Safety_Violation_Reject_List.Count > 0 && Model.Safety_Violation_Reject_List != null)
            {
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo_1" aria-expanded="false" aria-controls="collapseTwo_1" style="background: #00263a;color: white;height:30px;width:99%;">
                                    Reject List
                                </button>
                            </h2>
                            <div id="collapseTwo_1" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Reject ID</th>
                                                <th>Reject Reason</th>
                                                <th>Reject of Status</th>
                                                <th>Rejected By</th>
                                                <th>Created Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Safety_Violation_Reject_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Unique_Id</td>
                                                    <td align="left" valign="middle">@item.Reject_Reason</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.CreatedBy</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        }
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model!.Responsible_Dept == "Service_provider")
                            {
                                <label>Service provider</label>
                            }
                            else
                            {
                                <label>NCM Staff</label>
                            }

                        </td>
                    </tr>
                    <tr>

                        <td><b class="font-bold">Type Of Violation</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model.Safety_Violation_Sub_Type_List[0]!.Type_Master_Id == "-1")
                            {
                                <label>Others : @Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                            else
                            {
                                <label>@Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                        </td>

                        @if (@Model.Responsible_Dept == "Service_provider")
                        {
                            <td><b class="font-bold">Service provider</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Emp_Service_provider_Name</td>
                        }
                        else
                        {
                            <td></td>
                            <td></td>
                            <td></td>
                        }
                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Description of Violation</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Description_Violation</td>
                        </tr>
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Requirement(s)</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Requirement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Picture</b></td>
                            <td>:</td>
                            <td class="tdtxt">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        <a href="@item.File_Path" target="_blank">
                                            <img target="_blank" src="@item.File_Path" width="100" height="80" style="padding: 3px;">
                                        </a>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
        {
            <br />
            <div class="row">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                History of Approval
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Role</th>
                                            <th>Assigned/ Created Date</th>
                                            <th>Action Taken Date</th>
                                            <th>Prev.Status</th>
                                            <th>Cur.Status</th>
                                            <th>Next Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GettblIncidentHistory">
                                        @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                        {
                                            <tr class="clstr">
                                                <td align="left" valign="middle">@item.Emp_Name</td>
                                                <td align="left" valign="middle">@item.Role_Name</td>
                                                <td align="left" valign="middle">@item.Last_DateTime</td>
                                                <td align="left" valign="middle">@item.CreatedDate</td>
                                                <td align="left" valign="middle">@item.Status</td>
                                                <td align="left" valign="middle">@item.Remarks</td>
                                                <td align="left" valign="middle">@item.Next_Action</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        }
        @if (LoginClass.Role_Id == "9")
        {
            <div class="row col-lg-12">
                <div class="col-lg-6" style="text-align: right;">
                    <button data-bs-toggle="modal" data-bs-target=".add-Safe-Vio-Dir-Approval" type="button" style="background-color: green; border-color: green;" class="btn btn-success">
                        Approve
                    </button>
                </div>
                <div class="col-lg-6" style="text-align: left;">
                    <button onclick="Fn_SV_Rej()" data-bs-toggle="modal" data-bs-target=".add-Safe-Vio-Dir-Reject" type="button" class="btn btn-danger btn_Submit" id="btn-save-event"> Reject</button>
                </div>
            </div>
        }

    }
    if (Model.Status == "HSE Director Rejected")
    {
        if (Model.Safety_Violation_Reject_List != null)
        {
            @if (Model.Safety_Violation_Reject_List.Count > 0 && Model.Safety_Violation_Reject_List != null)
            {
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo_1" aria-expanded="false" aria-controls="collapseTwo_1" style="background: #00263a;color: white;height:30px;width:99%;">
                                    Reject List
                                </button>
                            </h2>
                            <div id="collapseTwo_1" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Reject ID</th>
                                                <th>Reject Reason</th>
                                                <th>Reject of Status</th>
                                                <th>Rejected By</th>
                                                <th>Created Date</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Safety_Violation_Reject_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Unique_Id</td>
                                                    <td align="left" valign="middle">@item.Reject_Reason</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.CreatedBy</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        }

        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <label style="margin-top: 10px;display: contents;" for="Yes"> <input required asp-for="Responsible_Dept" id="NCM_Staff" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="NCM_Staff" required>&nbsp;NCM Staff&nbsp;&nbsp;</label>
                            <label for="No"> <input required asp-for="Responsible_Dept" id="Service_provider" class="Responsible_Dept" name="Responsible_Dept" type="radio" value="Service_provider" required>&nbsp;Service provider</label>
                        </td>
                    </tr>
                    <tr class="Emp_Service_provider_Div" style="@(Model.Responsible_Dept == "Service_provider"?"":"display:none;")">
                        <td><b class="font-bold">Service provider</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            <select class="form-select Emp_Service_provider" asp-for="Emp_Service_provider" required name="Emp_Service_provider" id="Emp_Service_provider" asp-items="@(new SelectList(Model.Emp_Service_Provider_List,"Employee_Identity_Id","First_Name"))">
                                <option value="" disabled selected="selected">-- Select Service provider --</option>
                            </select>
                        </td>

                        <td></td>
                        <td></td>
                        <td></td>

                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>


            <div class="row">
                <br />
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <h5 class="card-title">&nbsp;&nbsp;TYPE OF VIOLATION<span class="requ">*</span></h5>
                </div>
            </div>
            <div class="row">
                @if (Model.Insp_Spot_Category_Master_List != null)
                {
                    @foreach (var item in Model.Insp_Spot_Category_Master_List)
                    {
                        <div class="col-lg-2">
                            <div class="col-md-12">
                                <div class="form-check mb-12">
                                    <input checked="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id==item.Value)?true:false)" class="form-check-input Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="@item.Value" id="Type_Violation_Mas_Id'@item.Value'">
                                    <label class="form-check-label Type_Violation_Mas_Name" id="Type_Violation_Mas_Name'@item.Value'" for="Type_Violation_Mas_Name'@item.Value'">@item.Text</label>
                                </div>
                            </div>
                        </div>
                    }

                    <div class="col-lg-2">
                        <div class="col-md-12">
                            <div class="form-check mb-12">
                                <input checked="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id=="-1")?true:false)" onclick="Fn_Type_Violation_Others(this.value)" class="form-check-input Type_Violation_Other_Id Type_Violation_Mas_Id" type="checkbox" name="Type_Violation_Mas_Id" value="-1" id="Type_Violation_Other_Id">
                                <label class="form-check-label" for="Type_Violation_Mas_Name">Others</label>
                            </div>
                        </div>

                    </div>
                    <div class="col-lg-3">
                        <textarea style="@(Model.Safety_Violation_Sub_Type_List!.Any(x=>x.Type_Master_Id=="-1")?"display:block;":"display:none;")" id="Type_Violation_Others_Text" class="form-control form-control-sm Type_Violation_Others_Text Type_Violation_Others_Div" name="Type_Violation_Others_Text" rows="1">@(Model.Safety_Violation_Sub_Type_List!.Any(x => x.Type_Master_Id == "-1") ? Model.Safety_Violation_Sub_Type_List![0].Others_Name : "")</textarea>
                    </div>

                    <label id="Type_Violation_Mas_Id" class="error text-danger" for="Type_Violation_Mas_Id"></label>
                }
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Description of Violation  <span class="requ">*</span>
                        </label>
                        &nbsp;&nbsp;<textarea id="Description_Violation" class="form-control TextArea_Autoresizing Description_Violation" name="Description_Violation" rows="2">@Model.Description_Violation</textarea>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="mb-6">
                        <label for="basicpill-lastname-input" class="form-label">
                            &nbsp;&nbsp;Requirement(s) <span class="requ">*</span>
                        </label>
                        <textarea id="Requirement" class="form-control TextArea_Autoresizing Requirement" name="Requirement" rows="2">@Model.Requirement</textarea>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:20%;"><b class="font-bold">Picture</b><br /><span style="color: #c5c5c5">Note: Format : jpg, png, jpeg, bmp</span></td>
                            <td>:</td>
                            <td class="tdtxt">
                                <input id="File_Safe_Picture" class="form-control File_Safe_Picture" onchange="Upload_Safe_Picture('File_Safe_Picture','Safe_UploadPicture')" type="file" accept=".png, .jpg, .jpeg, .bmp" style="width: 194px;" multiple>
                                <input type="hidden" value="" class="Safe_UploadPicture" name="Safe_UploadPicture" id="Safe_UploadPicture">
                            </td>
                        </tr>

                        <tr>
                            <td><b class="font-bold">Uploaded Pictures</b></td>
                            <td>:</td>
                            <td colspan="6">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    @foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        var Remove_Picture_Div = "Remove_Picture_Div" + item.Photo_Id;
                                        <span class="@Remove_Picture_Div">
                                            <a href="@item.File_Path" target="_blank">
                                                <img target="_blank" src="@item.File_Path" width="30" height="30">
                                            </a>
                                            <span style="color:red;cursor: pointer;" onclick="Fn_Safe_Photo_Delete(@item.Photo_Id)">Remove</span>
                                        </span>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>

                        </tr>

                    </tbody>
                </table>
            </div>
        </div>
        <br />
        @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
        {
            <br />
            <div class="row">
                <div class="accordion" id="accordionExample">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                History of Approval
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                    <thead>
                                        <tr>
                                            <th>Employee Name</th>
                                            <th>Role</th>
                                            <th>Assigned/ Created Date</th>
                                            <th>Action Taken Date</th>
                                            <th>Prev.Status</th>
                                            <th>Cur.Status</th>
                                            <th>Next Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="GettblIncidentHistory">
                                        @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                        {
                                            <tr class="clstr">
                                                <td align="left" valign="middle">@item.Emp_Name</td>
                                                <td align="left" valign="middle">@item.Role_Name</td>
                                                <td align="left" valign="middle">@item.Last_DateTime</td>
                                                <td align="left" valign="middle">@item.CreatedDate</td>
                                                <td align="left" valign="middle">@item.Status</td>
                                                <td align="left" valign="middle">@item.Remarks</td>
                                                <td align="left" valign="middle">@item.Next_Action</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        }
        <div class="AddSubmit_Div" id="AddSubmit_Div">
            <div style="text-align:center;">
                <button type="submit" class="btn btn-success btn_Submit" id="btn-save-event"> Submit</button>
            </div>
            <br />
        </div>
    }
    if (Model.Status == "Corrective Action Pending")
    {
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model!.Responsible_Dept == "Service_provider")
                            {
                                <label>Service provider</label>
                            }
                            else
                            {
                                <label>NCM Staff</label>
                            }

                        </td>
                    </tr>
                    <tr>

                        <td><b class="font-bold">Type Of Violation</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model.Safety_Violation_Sub_Type_List[0]!.Type_Master_Id == "-1")
                            {
                                <label>Others : @Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                            else
                            {
                                <label>@Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                        </td>

                        @if (@Model.Responsible_Dept == "Service_provider")
                        {
                            <td><b class="font-bold">Service provider</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Emp_Service_provider_Name</td>
                        }
                        else
                        {
                            <td></td>
                            <td></td>
                            <td></td>
                        }
                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Description of Violation</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Description_Violation</td>
                        </tr>
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Requirement(s)</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Requirement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Picture</b></td>
                            <td>:</td>
                            <td class="tdtxt">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        <a href="@item.File_Path" target="_blank">
                                            <img target="_blank" src="@item.File_Path" width="100" height="80" style="padding: 3px;">
                                        </a>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        @if (Model.Responsible_Dept == "Service_provider")
        {
            @if (Model.Emp_Service_provider == LoginClass.Employee_Identity_Id)
            {
                <br />
                <div class="row">
                    <div class="row">
                        <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                            <div class="card-header" style="background-color:#032639;height: 32px;">
                                <h5 class="card-title" style="color:white">D. Actions Taken And/or Recommended</h5>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <form id="F_Add_Corrective_Action">
                            <div class="col-lg-12">
                                <div class="mb-6">
                                    <label for="basicpill-lastname-input" class="form-label">
                                    </label> <br />
                                </div>
                                <div class="mb-6">
                                    <button type="button" style="background-color: #032639;color:white;float: right;height: 33px;margin-top: -38px;" class="btn btns" onclick="Fn_Add_More_Service_provider_Action()">+Add More</button>
                                </div>
                                <div class="table-responsive">
                                    <table id="Sub_ActionTable" class="Sub_ActionTable table-bordered table-sm tblround" style="width:100%;">
                                        <thead style="background-color:#0b5578">
                                            <tr>
                                                <th scope="col" class="table-responsive">Assign Action To</th>
                                                <th scope="col" class="table-responsive">Assignee</th>
                                                <th scope="col" class="table-responsive">Target Date</th>
                                                <th scope="col" class="table-responsive">Description</th>
                                                <th scope="col" class="table-responsive">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="Sub_ActionTable_Tbody" class="Sub_ActionTable_Tbody">
                                            <tr>
                                                <td style="min-width:150px;">
                                                    <input class="form-control SV_Corrective_Action_Id" value="0" type="hidden" id="SV_Corrective_Action_Id">
                                                    <input class="form-control Assignee_Type" value="Service_Provider" type="hidden" id="Assignee_Type">
                                                    <input class="form-control Responsibility_To" value="@LoginClass.Employee_Identity_Id" type="hidden" id="Responsibility_To">
                                                    <textarea id="" disabled class="form-control" name="" rows="1" required>@LoginClass.Company_Name</textarea>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <textarea id="" disabled class="form-control" name="" rows="1" required>@LoginClass.First_Name</textarea>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <input id="Target_Date" class="form-control Target_Date" type="date" name="Target_Date" required>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <textarea id="Action_Description" class="form-control Action_Description" name="Action_Description" rows="1" required></textarea>
                                                </td>
                                                <td style="min-width:100px;text-align: center;">
                                                    <a><i class="mdi mdi-delete-off font-size-18" style="color:red;"></i></a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
                                {
                                    <br />
                                    <div class="row">
                                        <div class="accordion" id="accordionExample">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                                        History of Approval
                                                    </button>
                                                </h2>
                                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                                    <div class="accordion-body">
                                                        <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Employee Name</th>
                                                                    <th>Role</th>
                                                                    <th>Assigned/ Created Date</th>
                                                                    <th>Action Taken Date</th>
                                                                    <th>Prev.Status</th>
                                                                    <th>Cur.Status</th>
                                                                    <th>Next Action</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblIncidentHistory">
                                                                @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                                                {
                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Emp_Name</td>
                                                                        <td align="left" valign="middle">@item.Role_Name</td>
                                                                        <td align="left" valign="middle">@item.Last_DateTime</td>
                                                                        <td align="left" valign="middle">@item.CreatedDate</td>
                                                                        <td align="left" valign="middle">@item.Status</td>
                                                                        <td align="left" valign="middle">@item.Remarks</td>
                                                                        <td align="left" valign="middle">@item.Next_Action</td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br />
                                }

                                <div class="row">
                                    <div class="col-lg-6">
                                        <button onclick="Fn_Action_Assign_Submit()" type="button" class="btn Fn_Action_Assign_Submit btn-success eva-plus-circle-outline icon nav-icon" style="float: right;">
                                            Submit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
            }
            else
            {
                @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
                {
                    <br />
                    <div class="row">
                        <div class="accordion" id="accordionExample">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingTwo">
                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                        History of Approval
                                    </button>
                                </h2>
                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                        <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                            <thead>
                                                <tr>
                                                    <th>Employee Name</th>
                                                    <th>Role</th>
                                                    <th>Assigned/ Created Date</th>
                                                    <th>Action Taken Date</th>
                                                    <th>Prev.Status</th>
                                                    <th>Cur.Status</th>
                                                    <th>Next Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="GettblIncidentHistory">
                                                @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                                {
                                                    <tr class="clstr">
                                                        <td align="left" valign="middle">@item.Emp_Name</td>
                                                        <td align="left" valign="middle">@item.Role_Name</td>
                                                        <td align="left" valign="middle">@item.Last_DateTime</td>
                                                        <td align="left" valign="middle">@item.CreatedDate</td>
                                                        <td align="left" valign="middle">@item.Status</td>
                                                        <td align="left" valign="middle">@item.Remarks</td>
                                                        <td align="left" valign="middle">@item.Next_Action</td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br />
                }

            }
        }
        else
        {
            @if (LoginClass.Role_Id == "5")
            {
                <br>
                <div class="row">

                    <div class="row">
                        <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                            <div class="card-header" style="background-color:#032639;height: 32px;">
                                <h5 class="card-title" style="color:white">D. Actions Taken And/or Recommended</h5>
                                <button type="button" style="background-color: #032639;color:white;float: right;height: 27px;margin-top: -7px;margin-right: -3px;" class="btn btn" value="Add" onclick="Fn_Add_More_Action()">+Add More</button>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-top: -17px;">
                        <form id="F_Add_Corrective_Action">
                            <div class="col-lg-12">
                                <div class="table-responsive">
                                    <table id="Sub_ActionTable" class="Sub_ActionTable table-bordered table-sm tblround" style="width:100%;">
                                        <thead style="background-color:#0b5578">
                                            <tr>
                                                <th scope="col" class="table-responsive">Assign Action To</th>
                                                <th scope="col" class="table-responsive">Assignee</th>
                                                <th scope="col" class="table-responsive">Target Date</th>
                                                <th scope="col" class="table-responsive">Description</th>
                                                <th scope="col" class="table-responsive">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="Sub_ActionTable_Tbody" class="Sub_ActionTable_Tbody">
                                            <tr>
                                                <td style="min-width:150px;">
                                                    <input class="form-control SV_Corrective_Action_Id" value="0" type="hidden" id="SV_Corrective_Action_Id">
                                                    <select onchange="FnAssignActionTo()" class="form-control Assignee_Type" required name="Assignee_Type" id="Assignee_Type">
                                                        <option value="" disabled selected="selected">-- Select Action to --</option>
                                                        <option value="Zone_Team">Zone Team</option>
                                                        <option value="Service_Provider">Service Provider</option>
                                                    </select>
                                                    <label id="Assignee_Type-error" style="font-size: small;" class="error" for="Assignee_Type"></label>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <select class="form-control Drop_Search Responsibility_To" required name="Responsibility_To" id="Responsibility_To">
                                                    </select>
                                                    <label id="Responsibility_To-error" style="font-size: small;" class="error" for="Responsibility_To"></label>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <input id="Target_Date" class="form-control Target_Date Target_Date_Validate" type="date" name="Target_Date" required>
                                                    <label id="Target_Date-error" style="font-size: small;" class="error" for="Target_Date"></label>
                                                </td>
                                                <td style="min-width:200px;">
                                                    <textarea id="Action_Description" class="form-control Action_Description" name="Action_Description" rows="1" required></textarea>
                                                    <label id="Action_Description-error" style="font-size: small;" class="error" for="Action_Description"></label>
                                                </td>
                                                <td style="min-width:100px;text-align: center;">
                                                    <a><i class="mdi mdi-delete-off font-size-18" style="color:red;"></i></a>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
                                {
                                    <br />
                                    <div class="row">
                                        <div class="accordion" id="accordionExample">
                                            <div class="accordion-item">
                                                <h2 class="accordion-header" id="headingTwo">
                                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                                        History of Approval
                                                    </button>
                                                </h2>
                                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                                    <div class="accordion-body">
                                                        <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                                            <thead>
                                                                <tr>
                                                                    <th>Employee Name</th>
                                                                    <th>Role</th>
                                                                    <th>Assigned/ Created Date</th>
                                                                    <th>Action Taken Date</th>
                                                                    <th>Prev.Status</th>
                                                                    <th>Cur.Status</th>
                                                                    <th>Next Action</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="GettblIncidentHistory">
                                                                @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                                                {
                                                                    <tr class="clstr">
                                                                        <td align="left" valign="middle">@item.Emp_Name</td>
                                                                        <td align="left" valign="middle">@item.Role_Name</td>
                                                                        <td align="left" valign="middle">@item.Last_DateTime</td>
                                                                        <td align="left" valign="middle">@item.CreatedDate</td>
                                                                        <td align="left" valign="middle">@item.Status</td>
                                                                        <td align="left" valign="middle">@item.Remarks</td>
                                                                        <td align="left" valign="middle">@item.Next_Action</td>
                                                                    </tr>
                                                                }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br />
                                }

                                <div class="row">
                                    <div class="col-lg-6">
                                        <button onclick="Fn_Action_Assign_Submit()" type="button" class="btn btn-success Fn_Action_Assign_Submit eva-plus-circle-outline icon nav-icon" style="float: right;">
                                            Submit
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                </div>
            }
            else
            {
                @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
                {
                    <br />
                    <div class="row">
                        <div class="accordion" id="accordionExample">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingTwo">
                                    <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                        History of Approval
                                    </button>
                                </h2>
                                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                        <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                            <thead>
                                                <tr>
                                                    <th>Employee Name</th>
                                                    <th>Role</th>
                                                    <th>Assigned/ Created Date</th>
                                                    <th>Action Taken Date</th>
                                                    <th>Prev.Status</th>
                                                    <th>Cur.Status</th>
                                                    <th>Next Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="GettblIncidentHistory">
                                                @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                                {
                                                    <tr class="clstr">
                                                        <td align="left" valign="middle">@item.Emp_Name</td>
                                                        <td align="left" valign="middle">@item.Role_Name</td>
                                                        <td align="left" valign="middle">@item.Last_DateTime</td>
                                                        <td align="left" valign="middle">@item.CreatedDate</td>
                                                        <td align="left" valign="middle">@item.Status</td>
                                                        <td align="left" valign="middle">@item.Remarks</td>
                                                        <td align="left" valign="middle">@item.Next_Action</td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br />
                }

            }
        }


    }
    if (Model.Status == "Action Closure Pending")
    {
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model!.Responsible_Dept == "Service_provider")
                            {
                                <label>Service provider</label>
                            }
                            else
                            {
                                <label>NCM Staff</label>
                            }

                        </td>
                    </tr>
                    <tr>

                        <td><b class="font-bold">Type Of Violation</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model.Safety_Violation_Sub_Type_List[0]!.Type_Master_Id == "-1")
                            {
                                <label>Others : @Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                            else
                            {
                                <label>@Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                            }
                        </td>

                        @if (@Model.Responsible_Dept == "Service_provider")
                        {
                            <td><b class="font-bold">Service provider</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Emp_Service_provider_Name</td>
                        }
                        else
                        {
                            <td></td>
                            <td></td>
                            <td></td>
                        }
                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Description of Violation</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Description_Violation</td>
                        </tr>
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Requirement(s)</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Requirement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />

        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Picture</b></td>
                            <td>:</td>
                            <td class="tdtxt">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        <a href="@item.File_Path" target="_blank">
                                            <img target="_blank" src="@item.File_Path" width="100" height="80" style="padding: 3px;">
                                        </a>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">D. Actions Taken And/or Recommended</h5>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: -14px;">
                <form id="F_Add_Corrective_Action">
                    <div class="col-lg-12">
                        <table id="Sub_ActionTable" class="Sub_ActionTable table-sm tblround table table-bordered" style="width:100%;">
                            <thead style="background-color:#0b5578">
                                <tr>
                                    <th scope="col" class="table-responsive">S.No</th>
                                    <th scope="col" class="table-responsive">Assign Action To</th>
                                    <th scope="col" class="table-responsive">Assignee</th>
                                    <th scope="col" class="table-responsive">Target Date</th>
                                    <th scope="col" class="table-responsive">Action Description</th>
                                    <th scope="col" class="table-responsive">Closure Description</th>
                                    <th scope="col" class="table-responsive">Evidence</th>
                                    <th scope="col" class="table-responsive">Status</th>
                                    <th scope="col" class="table-responsive">Action</th>
                                </tr>
                            </thead>
                            <tbody id="Sub_ActionTable_Tbody" class="Sub_ActionTable_Tbody">
                                @if (Model.Safety_Violation_CA_List != null)
                                {
                                    var Ac_subSno = 1;
                                    foreach (var item_Ca in Model.Safety_Violation_CA_List)
                                    {
                                        <tr class="CA_Approval_tr_@Ac_subSno">
                                            <td>
                                                <input class="form-control SV_Corrective_Action_Id" value="@item_Ca.SV_Corrective_Action_Id" type="hidden" id="SV_Corrective_Action_Id_@Ac_subSno">
                                                <label>@Ac_subSno</label>
                                            </td>
                                            <td><label>@item_Ca.Assignee_Type</label></td>
                                            <td><label>@item_Ca.Responsibility_To_Name</label></td>
                                            <td><label>@item_Ca.Target_Date</label></td>
                                            <td><label>@item_Ca.Action_Description</label></td>
                                            <td><label>@item_Ca.Closure_Action_Description</label></td>
                                            <td>
                                                @if (@item_Ca.Insp_SV_CA_Photo_List != null)
                                                {
                                                    @foreach (var item_Ca_P in @item_Ca.Insp_SV_CA_Photo_List!)
                                                    {
                                                        var extn = @item_Ca_P.File_Path!.Split(".").Last();
                                                        <a href="@item_Ca_P.File_Path" target="_blank">
                                                            @if (extn == "png" || extn == "jpeg" || extn == "jpg")
                                                            {
                                                                <img target="_blank" src="@item_Ca_P.File_Path" width="35" height="35">
                                                            }
                                                            else
                                                            {
                                                                <img src='~/assets/images/pdf.png' style="height: 25px;width: 25px;margin-left: 12px;margin-top: -8px;cursor: pointer;" />
                                                            }
                                                        </a>
                                                    }
                                                }
                                                else
                                                {
                                                    <label>NA</label>
                                                }

                                            </td>
                                            <td class="CA_Approval_td_@Ac_subSno">
                                                @if (@item_Ca.Status == "Completed")
                                                {
                                                    <label style="color:green;">@item_Ca.Status</label>
                                                }
                                                else if (@item_Ca.Status == "Rejected")
                                                {
                                                    <label style="color:red;">@item_Ca.Status</label>
                                                }
                                                else
                                                {
                                                    <label style="color:#17a2b8;">@item_Ca.Status</label>
                                                }
                                            </td>


                                            <td style="width: 170px;text-align:center;">
                                                @if (LoginClass.Role_Id == "9" || LoginClass.Role_Id == "10" || LoginClass.Role_Id == "11")
                                                {
                                                    @if (@item_Ca.Status == "Action Closure Pending" || @item_Ca.Status == "Supervisor Approval Pending" || @item_Ca.Status == "Rejected")
                                                    {
                                                        if (@item_Ca.Assignee_Type == "Zone Team")
                                                        {
                                                            if (@item_Ca.Insp_SV_CA_Reject_List != null && @item_Ca.Insp_SV_CA_ReAssign_List != null)
                                                            {
                                                                <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                                <i onclick="FnViewReAssignDetails('@item_Ca.Insp_SV_CA_ReAssign_List[0].Unique_Id','@item_Ca.Insp_SV_CA_ReAssign_List[0].Responsibility_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].Re_Assign_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].CreatedDate','@item_Ca.Insp_SV_CA_ReAssign_List[0].Remarks')" data-bs-toggle="modal" data-bs-target=".View_CA_Re_Asign_Details" class="mdi mdi-calendar-text" title="Re-Assign Details" data-bs-original-title="Re-Assign Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                            }
                                                            else if (@item_Ca.Insp_SV_CA_Reject_List != null && @item_Ca.Insp_SV_CA_ReAssign_List == null)
                                                            {
                                                                <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                            }
                                                            else if (@item_Ca.Insp_SV_CA_Reject_List == null && @item_Ca.Insp_SV_CA_ReAssign_List != null)
                                                            {
                                                                <i onclick="FnViewReAssignDetails('@item_Ca.Insp_SV_CA_ReAssign_List[0].Unique_Id','@item_Ca.Insp_SV_CA_ReAssign_List[0].Responsibility_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].Re_Assign_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].CreatedDate','@item_Ca.Insp_SV_CA_ReAssign_List[0].Remarks')" data-bs-toggle="modal" data-bs-target=".View_CA_Re_Asign_Details" class="mdi mdi-calendar-text" title="Re-Assign Details" data-bs-original-title="Re-Assign Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                            }
                                                            else
                                                            {
                                                                <label class="Dash_Show_Hide_@Ac_subSno">--</label>
                                                            }
                                                        }
                                                        else
                                                        {
                                                            <label class="Dash_Show_Hide_@Ac_subSno">--</label>
                                                        }
                                                    }
                                                    else if (@item_Ca.Status == "Completed")
                                                    {
                                                        <i class="mdi mdi-sticker-check font-size-25 tick_Show_Hide_@Ac_subSno" style="color:green"></i>
                                                    }
                                                    else
                                                    {
                                                        <button type="button" onclick="Fn_CA_Approval_Submit(@item_Ca.SV_Corrective_Action_Id,'Approve','5')" class="btn btn-success eva-plus-circle-outline icon nav-icon button_Show_Hide_@Ac_subSno" style="height: 28px;width: 75px;background-color: green;border: green;">Approve</button>
                                                        <button onclick="Fn_CA_Rej_Model(@item_Ca.SV_Corrective_Action_Id)" data-bs-toggle="modal" data-bs-target=".Add_CA_Rej" type="button" class="btn btn-success eva-plus-circle-outline icon nav-icon button_Show_Hide_@Ac_subSno" style="height: 28px;width: 63px;background-color: red;border: red;" id="btn-save-event">Reject</button>

                                                        if (@item_Ca.Insp_SV_CA_Reject_List != null && @item_Ca.Insp_SV_CA_ReAssign_List != null)
                                                        {
                                                            <br />
                                                            <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                            <i onclick="FnViewReAssignDetails('@item_Ca.Insp_SV_CA_ReAssign_List[0].Unique_Id','@item_Ca.Insp_SV_CA_ReAssign_List[0].Responsibility_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].Re_Assign_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].CreatedDate','@item_Ca.Insp_SV_CA_ReAssign_List[0].Remarks')" data-bs-toggle="modal" data-bs-target=".View_CA_Re_Asign_Details" class="mdi mdi-calendar-text" title="Re-Assign Details" data-bs-original-title="Re-Assign Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                        }
                                                        else if (@item_Ca.Insp_SV_CA_Reject_List != null && @item_Ca.Insp_SV_CA_ReAssign_List == null)
                                                        {
                                                            <br />
                                                            <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                        }
                                                        else if (@item_Ca.Insp_SV_CA_Reject_List == null && @item_Ca.Insp_SV_CA_ReAssign_List != null)
                                                        {
                                                            <br />
                                                            <i onclick="FnViewReAssignDetails('@item_Ca.Insp_SV_CA_ReAssign_List[0].Unique_Id','@item_Ca.Insp_SV_CA_ReAssign_List[0].Responsibility_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].Re_Assign_To','@item_Ca.Insp_SV_CA_ReAssign_List[0].CreatedDate','@item_Ca.Insp_SV_CA_ReAssign_List[0].Remarks')" data-bs-toggle="modal" data-bs-target=".View_CA_Re_Asign_Details" class="mdi mdi-calendar-text" title="Re-Assign Details" data-bs-original-title="Re-Assign Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                        }
                                                    }

                                                }
                                                else if (LoginClass.Role_Id == "5")
                                                {
                                                    @*                                                    @if (@item_Ca.Status == "Supervisor Approval Pending" && LoginClass.Employee_Identity_Id == @item_Ca.CreatedBy)
                                *@                                                    @if (@item_Ca.Status == "Supervisor Approval Pending")
                                                    {
                                                        <button type="button" onclick="Fn_CA_Approval_Submit(@item_Ca.SV_Corrective_Action_Id,'Approve','6')" class="btn btn-success eva-plus-circle-outline icon nav-icon" style="height: 28px;width: 75px;background-color: green;border: green;">Accept</button>
                                                        <button onclick="Fn_CA_Rej_Model(@item_Ca.SV_Corrective_Action_Id)" data-bs-toggle="modal" data-bs-target=".Add_CA_Rej" type="button" class="btn btn-success eva-plus-circle-outline icon nav-icon" style="height: 28px;width: 63px;background-color: red;border: red;" id="btn-save-event">Reject</button>
                                                        if (@item_Ca.Assignee_Type == "Service Provider")
                                                        {
                                                            if (@item_Ca.Insp_SV_CA_Reject_List != null)
                                                            {
                                                                <br />
                                                                <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                            }
                                                        }
                                                    }
                                                    else if (@item_Ca.Status == "Completed")
                                                    {
                                                        <i class="mdi mdi-sticker-check font-size-25" style="color:green"></i>
                                                    }
                                                    else if (@item_Ca.Status == "Rejected" && @item_Ca.Assignee_Type == "Service Provider")
                                                    {
                                                        if (@item_Ca.Insp_SV_CA_Reject_List != null)
                                                        {
                                                            <br />
                                                            <i onclick="FnViewRejectDetails('@item_Ca.Insp_SV_CA_Reject_List[0].Unique_Id','@item_Ca.Insp_SV_CA_Reject_List[0].Reject_Reason','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedDate','@item_Ca.Insp_SV_CA_Reject_List[0].CreatedBy')" data-bs-toggle="modal" data-bs-target=".View_CA_Rej_Details" class="mdi mdi-note-text" title="Reject Details" data-bs-original-title="Reject Details" aria-label="View" style="cursor: pointer;font-size:25px;"></i>
                                                        }
                                                        else
                                                        {
                                                            <label>--</label>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <label>--</label>
                                                    }
                                                }
                                                else
                                                {
                                                    <label>--</label>
                                                }
                                            </td>
                                        </tr>
                                        Ac_subSno++;
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </form>
            </div>
            @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
            {
                <br />
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                    History of Approval
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Employee Name</th>
                                                <th>Role</th>
                                                <th>Assigned/ Created Date</th>
                                                <th>Action Taken Date</th>
                                                <th>Prev.Status</th>
                                                <th>Cur.Status</th>
                                                <th>Next Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Emp_Name</td>
                                                    <td align="left" valign="middle">@item.Role_Name</td>
                                                    <td align="left" valign="middle">@item.Last_DateTime</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                    <td align="left" valign="middle">@item.Status</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.Next_Action</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        </div>
    }
    if (Model.Status == "Completed")
    {
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">A. Violation Information</h5>
                    </div>
                </div>
            </div>
            <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                <tbody id="">
                    <tr>
                        <td><b class="font-bold">Date Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Date</td>

                        <td><b class="font-bold">Time Of Observation</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Inspection_Time</td>

                        <td><b class="font-bold">Business Unit</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Business_Unit_Name</td>
                    </tr>
                    <tr>
                        <td><b class="font-bold">Zone</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Zone_Name</td>

                        <td><b class="font-bold">Community</b></td>
                        <td>:</td>
                        <td class="tdtxt">@Model!.Community_Name</td>

                        <td><b class="font-bold">Responsible Department</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model!.Responsible_Dept == "Service_provider")
                            {
                                <label>Service provider</label>
                            }
                            else
                            {
                                <label>NCM Staff</label>
                            }

                        </td>
                    </tr>
                    <tr>

                        <td><b class="font-bold">Type Of Violation</b></td>
                        <td>:</td>
                        <td class="tdtxt">
                            @if (@Model.Safety_Violation_Sub_Type_List != null)
                            {
                                @if (@Model.Safety_Violation_Sub_Type_List[0]!.Type_Master_Id == "-1")
                                {
                                    <label>Others : @Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                                }
                                else
                                {
                                    <label>@Model.Safety_Violation_Sub_Type_List[0].Type_Master_Name</label>
                                }
                            }

                        </td>

                        @if (@Model.Responsible_Dept == "Service_provider")
                        {
                            <td><b class="font-bold">Service provider</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Emp_Service_provider_Name</td>
                        }
                        else
                        {
                            <td></td>
                            <td></td>
                            <td></td>
                        }
                        <td></td>
                        <td></td>
                        <td></td>

                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">B. Brief Description Of Violation & Requirement(s)</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Description of Violation</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model.Description_Violation</td>
                        </tr>
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Requirement(s)</b></td>
                            <td>:</td>
                            <td class="tdtxt">@Model!.Requirement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />

        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">C. Photograph</h5>
                    </div>
                </div>
            </div>
            <div class="row">
                <table class="table table-sm" style="margin-bottom: 0px;margin-top: -8px;">
                    <tbody id="">
                        <tr>
                            <td style="width:14%;"><b class="font-bold">Picture</b></td>
                            <td>:</td>
                            <td class="tdtxt">
                                @if (@Model.Insp_Safe_Vio_Photos_List != null && @Model.Insp_Safe_Vio_Photos_List.Count > 0)
                                {
                                    foreach (var item in @Model.Insp_Safe_Vio_Photos_List)
                                    {
                                        <a href="@item.File_Path" target="_blank">
                                            <img target="_blank" src="@item.File_Path" width="100" height="80" style="padding: 3px;">
                                        </a>
                                    }
                                }
                                else
                                {
                                    <label>NA</label>
                                }
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <br />
        <div class="row">
            <div class="row">
                <div class="card" style="border-radius: 0rem !important;box-shadow: 0 0px 0px #e4e8f0;border: 0px solid #eff0f2;">
                    <div class="card-header" style="background-color:#032639;height: 32px;">
                        <h5 class="card-title" style="color:white">D. Actions Taken And/or Recommended</h5>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: -14px;">
                <form id="F_Add_Corrective_Action">
                    <div class="col-lg-12">
                        <table id="Sub_ActionTable" class="Sub_ActionTable table-sm tblround table table-bordered" style="width:100%;">
                            <thead style="background-color:#0b5578">
                                <tr>
                                    <th scope="col" class="table-responsive">S.No</th>
                                    <th scope="col" class="table-responsive">Assign Action To</th>
                                    <th scope="col" class="table-responsive">Assignee</th>
                                    <th scope="col" class="table-responsive">Target Date</th>
                                    <th scope="col" class="table-responsive">Action Description</th>
                                    <th scope="col" class="table-responsive">Closure Description</th>
                                    <th scope="col" class="table-responsive">Evidence</th>
                                    <th scope="col" class="table-responsive">Status</th>
                                </tr>
                            </thead>
                            <tbody id="Sub_ActionTable_Tbody" class="Sub_ActionTable_Tbody">
                                @if (Model.Safety_Violation_CA_List != null)
                                {
                                    var Ac_subSno = 1;
                                    foreach (var item_Ca in Model.Safety_Violation_CA_List)
                                    {
                                        <tr class="CA_Approval_tr_@Ac_subSno">
                                            <td>
                                                <input class="form-control SV_Corrective_Action_Id" value="@item_Ca.SV_Corrective_Action_Id" type="hidden" id="SV_Corrective_Action_Id_@Ac_subSno">
                                                <label>@Ac_subSno</label>
                                            </td>
                                            <td><label>@item_Ca.Assignee_Type</label></td>
                                            <td><label>@item_Ca.Responsibility_To_Name</label></td>
                                            <td><label>@item_Ca.Target_Date</label></td>
                                            <td><label>@item_Ca.Action_Description</label></td>
                                            <td><label>@item_Ca.Closure_Action_Description</label></td>
                                            <td>
                                                @if (@item_Ca.Insp_SV_CA_Photo_List != null)
                                                {
                                                    @foreach (var item_Ca_P in @item_Ca.Insp_SV_CA_Photo_List!)
                                                    {
                                                        var extn = @item_Ca_P.File_Path!.Split(".").Last();
                                                        <a href="@item_Ca_P.File_Path" target="_blank">
                                                            @if (extn == "png" || extn == "jpeg" || extn == "jpg")
                                                            {
                                                                <img target="_blank" src="@item_Ca_P.File_Path" width="35" height="35">
                                                            }
                                                            else
                                                            {
                                                                <img src='~/assets/images/pdf.png' style="height: 25px;width: 25px;margin-left: 12px;margin-top: -8px;cursor: pointer;" />
                                                            }
                                                        </a>
                                                    }
                                                }
                                                else
                                                {
                                                    <label>NA</label>
                                                }

                                            </td>
                                            <td class="CA_Approval_td_@Ac_subSno">
                                                @if (@item_Ca.Status == "Completed")
                                                {
                                                    <label style="color:green;">@item_Ca.Status</label>
                                                }
                                                else if (@item_Ca.Status == "Rejected")
                                                {
                                                    <label style="color:red;">@item_Ca.Status</label>
                                                }
                                                else
                                                {
                                                    <label style="color:#17a2b8;">@item_Ca.Status</label>
                                                }
                                            </td>
                                        </tr>
                                        Ac_subSno++;
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </form>
            </div>
            @if (Model.Insp_Safe_Vio_Approval_History_List != null && Model.Insp_Safe_Vio_Approval_History_List.Count != 0)
            {
                <br />
                <div class="row">
                    <div class="accordion" id="accordionExample">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button fw-medium collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="background: #00263a;color: white;height:30px;width:99%;">
                                    History of Approval
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                                <div class="accordion-body">
                                    <table id="tblIncidentHistory" class="table table-sm table-striped dt-responsive nowrap tblround" style="width:100%;font-size:13px;">
                                        <thead>
                                            <tr>
                                                <th>Employee Name</th>
                                                <th>Role</th>
                                                <th>Assigned/ Created Date</th>
                                                <th>Action Taken Date</th>
                                                <th>Prev.Status</th>
                                                <th>Cur.Status</th>
                                                <th>Next Action</th>
                                            </tr>
                                        </thead>
                                        <tbody id="GettblIncidentHistory">
                                            @foreach (var item in Model.Insp_Safe_Vio_Approval_History_List)
                                            {
                                                <tr class="clstr">
                                                    <td align="left" valign="middle">@item.Emp_Name</td>
                                                    <td align="left" valign="middle">@item.Role_Name</td>
                                                    <td align="left" valign="middle">@item.Last_DateTime</td>
                                                    <td align="left" valign="middle">@item.CreatedDate</td>
                                                    <td align="left" valign="middle">@item.Status</td>
                                                    <td align="left" valign="middle">@item.Remarks</td>
                                                    <td align="left" valign="middle">@item.Next_Action</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
            }
        </div>
    }
}


<script>
    $(document).ready(function () {

        //var dtToday = new Date();
        //var month = dtToday.getMonth() + 1;
        //var day = dtToday.getDate();
        //var year = dtToday.getFullYear();
        //if (month < 10)
        //    month = '0' + month.toString();
        //if (day < 10)
        //    day = '0' + day.toString();
        //var minDate = year + '-' + month + '-' + day;
        //minDate_valid = minDate;
        //$('.Target_Date').attr('min', minDate);
        let minDate = '@TempData["SV_msg_Insp_Date"]';
        $('.Target_Date_Validate').attr('min', minDate);

        $(".Sub_ActionTable").on("click", ".btn_Action_Delete_Button", function () {
            $(this).closest("tr").remove();
        });
        $('.TextArea_Autoresizing').on('input', function () {
            this.style.height = 'auto';

            this.style.height =
                (this.scrollHeight) + 'px';
        });

        $('input[name="Type_Violation_Mas_Id"]').on('change', function () {
            $('input[name="' + this.name + '"]').not(this).prop('checked', false);
            if ($("input[type='checkbox'].Type_Violation_Other_Id").is(':checked')) {
                $(".Type_Violation_Others_Div").show()
            } else {
                $("#Type_Violation_Others_Text").val('');
                $(".Type_Violation_Others_Div").hide();
                $("#Type_Violation_Others_Text-error").hide();
            }
        });

        $('input[type=radio][name=Responsible_Dept]').change(function () {
            if (this.value == 'NCM_Staff') {
                $(".Emp_Service_provider_Div").hide();
                $(".Emp_Service_provider").val("");
            }
            else {
                $(".Emp_Service_provider_Div").show();
                $(".Emp_Service_provider").val("");
            }
        });

        var $el1 = $("#inputPhoto");
        $el1.fileinput({
            allowedFileExtensions: ['jpg', 'png', 'jpeg', 'bmp'],
            uploadUrl: '/Inspection/UploadPhotoFiles',
            uploadAsync: false,
            //deleteUrl: '/Incident/DeletePhotoFiles',
            showRemove: false,
            showUpload: false, // hide upload button
            overwriteInitial: false, // append files to initial preview
            minFileCount: 1,
            maxFileCount: 5,
            browseOnZoneClick: true,
            initialPreviewAsData: true,
        }).on("filebatchselected", function (event, files) {
            $el1.fileinput("upload");
        });

        ApplySelect2(".Drop_Search");
    });
    function Fn_Type_Violation_Others(val) {
        if ($("input[type='checkbox'].Type_Violation_Other_Id").is(':checked')) {
            $(".Type_Violation_Others_Div").show()
        } else {
            $("#Type_Violation_Others_Text").val('');
            $(".Type_Violation_Others_Div").hide()
        }
    }

    var Html = 1;
    function Fn_Add_More_Action() {
        var MainID = Html;
        Datamarkup = '<tr><td style="min-width:150px;"><input class="form-control SV_Corrective_Action_Id" value="0" type="hidden" id="Corrective_Action_Id' + MainID + '"><select onchange="FnAssignActionTo_More(' + "'" + MainID + "'" + ')" class="form-control Assignee_Type" required name="Assignee_Type_' + MainID + '" id="Assignee_Type_' + MainID + '"><option value="" disabled selected="selected">-- Select Action to --</option><option value="Zone_Team">Zone Team</option><option value="Service_Provider">Service Provider</option></select><label id="Assignee_Type_' + MainID + '-error" class="error" style="font-size: small;" for="Assignee_Type_' + MainID + '"></label></td>',
            Datamarkup += '<td style="min-width:200px;"><select class="form-control Drop_Search Responsibility_To" required name="Responsibility_To_' + MainID + '" id="Responsibility_To_' + MainID + '"></select><label id="Responsibility_To_' + MainID + '-error" class="error" style="font-size: small;" for="Responsibility_To_' + MainID + '"></label></td>',
            Datamarkup += '<td style="min-width:200px;"><input id="Target_Date_' + MainID + '" class="form-control Target_Date Target_Date_Validate" type="date" name="Target_Date_' + MainID + '" required><label id="Target_Date_' + MainID + '-error" class="error" style="font-size: small;" for="Target_Date_' + MainID + '"></label></td>',
            Datamarkup += '<td style="min-width:200px;"><textarea id="Action_Description_' + MainID + '" class="form-control Action_Description" name="Action_Description_' + MainID + '" rows="1" required></textarea><label id="Action_Description_' + MainID + '-error" class="error" style="font-size: small;" for="Action_Description_' + MainID + '"></label></td>',
            Datamarkup += '<td style="min-width:100px;text-align: center;"><a><i class="mdi mdi-delete btn_Action_Delete_Button font-size-18" style="color:red;"></i></a></td>',
            Datamarkup += '</tr>'

        $('#Sub_ActionTable').append(Datamarkup);
        var Target_Date_Valid = "#Target_Date_" + MainID;
        //var dtToday = new Date();
        //var month = dtToday.getMonth() + 1;
        //var day = dtToday.getDate();
        //var year = dtToday.getFullYear();
        //if (month < 10)
        //    month = '0' + month.toString();
        //if (day < 10)
        //    day = '0' + day.toString();
        //var minDate = year + '-' + month + '-' + day;
        var minDate = '@TempData["SV_msg_Insp_Date"]';
        $(Target_Date_Valid).attr('min', minDate);
        ApplySelect2(".Drop_Search");
        Html++;
    }

    var Html_s = 1;
    function Fn_Add_More_Service_provider_Action() {
        var MainID_s = Html_s;
        var First_Name = '@LoginClass.First_Name';
        var Company_Name = '@LoginClass.Company_Name';
        var Datamarkups = "";
        Datamarkups = '<tr><td style="min-width:150px;"><input class="form-control SV_Corrective_Action_Id" value="0" type="hidden" id="Corrective_Action_Id' + MainID_s + '"><input class="form-control Assignee_Type" value="Service_Provider" type="hidden" id="Assignee_Type' + MainID_s + '"><input class="form-control Responsibility_To" value="' + @LoginClass.Employee_Identity_Id+'" type="hidden" id="Responsibility_To' + MainID_s + '"><textarea id="" disabled class="form-control" name="" rows="1" required>' + Company_Name + '</textarea></td>',
            Datamarkups += '<td style="min-width:200px;"><textarea id="" disabled class="form-control" name="" rows="1" required>' + First_Name + '</textarea></td>',
            Datamarkups += '<td style="min-width:200px;"><input id="Target_Date_' + MainID_s + '" class="form-control Target_Date" type="date" name="Target_Date_' + MainID_s + '" required></td>',
            Datamarkups += '<td style="min-width:200px;"><textarea id="Action_Description_' + MainID_s + '" class="form-control Action_Description" name="Action_Description_' + MainID_s + '" rows="1" required></textarea></td>',
            Datamarkups += '<td style="min-width:100px;text-align: center;"><a><i class="mdi mdi-delete btn_Action_Delete_Button font-size-18" style="color:red;"></i></a></td>',
            Datamarkups += '</tr>'
        $('.Sub_ActionTable').append(Datamarkups);
        Html_s++;
    }
    function FnAssignActionTo() {
        var Role_Name = "";
        var Input_Id = "Responsibility_To";
        Role_Name = $('#Assignee_Type').val();
        var Zone_Id = $('#Zone_Id').val();
        var Community_Id = $('#Community_Id').val();
        if (Role_Name == "Service_Provider") {
            EMP_DRP_DWN(Role_Name, Input_Id, Zone_Id, Community_Id);
        }
        else {
            Role_Name = "Supervisor";
            EMP_DRP_DWN(Role_Name, Input_Id, Zone_Id, Community_Id);
        }
    }

    function FnAssignActionTo_More(Main_Id) {
        var Role_Name = "";
        var Input_Id = "Responsibility_To_" + Main_Id;
        Role_Name = $('#Assignee_Type_' + Main_Id + '').val();
        var Zone_Id = $('#Zone_Id').val();
        var Community_Id = $('#Community_Id').val();
        if (Role_Name == "Service_Provider") {
            EMP_DRP_DWN(Role_Name, Input_Id, Zone_Id, Community_Id);
        }
        else {
            Role_Name = "Supervisor";
            EMP_DRP_DWN(Role_Name, Input_Id, Zone_Id, Community_Id);
        }
    }
    function EMP_DRP_DWN(Role_Name, Input_Id, Zone_Id, Community_Id) {
        $.post("@Url.Action("LoadEmpbyRole", "CommonMaster")", { Role_Name: Role_Name, Zone_Id: Zone_Id, Community_Id: Community_Id }, function (data) {
            $("#" + Input_Id).empty();
            $("#" + Input_Id).append("<option value='' style='text-align:center'>--Select--</option>");
            $(data).each(function (i, e) {
                $("#" + Input_Id).append("<option value=" + e.Employee_Identity_Id + ">" + e.First_Name + "</option>");
            });
        });
    }
    function EMP_DRP_DWN_Service(Role_Name, Input_Id, Zone_Id, Community_Id) {
        $.post("@Url.Action("LoadEmpbyRole", "CommonMaster")", { Role_Name: Role_Name, Zone_Id: Zone_Id, Community_Id: Community_Id }, function (data) {
            $("#" + Input_Id).empty();
            $("#" + Input_Id).append("<option value='' style='text-align:center'>--Select--</option>");
            $(data).each(function (i, e) {
                $("#" + Input_Id).append("<option value=" + e.Employee_Identity_Id + ">" + e.First_Name + "</option>");
            });
        });
    }

    function Fn_Action_Assign_Submit() {
        let valid = $("#F_Add_Corrective_Action").valid();
        if (!valid) {
            return false;
        }
        $('.Fn_Action_Assign_Submit').attr('disabled', true);

        var ActionArr = [];
        var varSafety_Violation_Id = $("#Safety_Violation_Id").val();

        $('#Sub_ActionTable tbody > tr').each(function (c) {

            var varSV_Corrective_Action_Id = $(this).closest('tr').find('.SV_Corrective_Action_Id').val();
            var varAssignee_Type = $(this).closest('tr').find('.Assignee_Type').val();
            var varResponsibility_To = $(this).closest('tr').find('.Responsibility_To').val();
            var varTarget_Date = $(this).closest('tr').find('.Target_Date').val();
            var varAction_Description = $(this).closest('tr').find('.Action_Description').val();

            var data = {};
            data.SV_Corrective_Action_Id = varSV_Corrective_Action_Id;
            data.Assignee_Type = varAssignee_Type;
            data.Responsibility_To = varResponsibility_To;
            data.Target_Date = varTarget_Date;
            data.Action_Description = varAction_Description;
            data.Safety_Violation_Id = varSafety_Violation_Id;
            ActionArr.push(data);
        });

        $.post("@Url.Action("Insp_Safe_Vio_Corrective_Action_Add", "Inspection")", { model: ActionArr }, function (data) {
            if (data == "200") {
                Swal.fire({
                    position: 'top-end',
                    icon: 'success',
                    title: 'Added Successfully',
                    showConfirmButton: false,
                    timer: 1500
                }).then(function () {
                    window.location.reload();
                });
            }
            else {
                Swal.fire({
                    position: 'top-end',
                    icon: 'Error',
                    title: 'Error',
                    showConfirmButton: false,
                    timer: 1500
                });
                $('.Fn_Action_Assign_Submit').attr('disabled', false);
            }
            $('.Fn_Action_Assign_Submit').attr('disabled', false);
        });
    }
    function ApplySelect2(id) {
        $(id).select2({
            placeholder: "--Select--",
            theme: 'bootstrap-5',
        });
    }

    function Fn_Safe_Photo_Delete(Photo_Id) {
        Swal.fire(
            {
                title: "Are you sure?",
                text: "You won't be able to revert this!",
                icon: "warning", showCancelButton: !0,
                confirmButtonColor: "#34c38f",
                cancelButtonColor: "#f46a6a",
                confirmButtonText: "Yes, delete it!"
            }).then(function (t) {
                if (t.isConfirmed) {
                    $.ajax({
                        url: '@Html.Raw(@Url.Action("Insp_Safe_Photo_Delete", "Inspection"))',
                        type: "POST",
                        cache: false,
                        async: false,
                        data: { Photo_Id: Photo_Id },
                        dataType: "json",
                        success: function (data) {
                            if (data == "200") {
                                var del_Class = ".Remove_Picture_Div" + Photo_Id;
                                $(del_Class).remove();
                                Swal.fire("Deleted!", "Your file has been deleted.", "success");
                            }
                            else {
                                Swal.fire("Failed!", "Something went wrong", "error");
                                return false;
                            }
                        },
                    });
                }
            });
    }


    //function Upload_Safe_Picture(inputId, UploadPhotoId) {
    //    var input = document.getElementById(inputId);
    //    var files = input.files;
    //    var formData = new FormData();

    //    if (files.length <= 5) {

    //        for (var i = 0; i != files.length; i++) {
    //            formData.append("files", files[i]);
    //        }

    //        var _url = '@Url.Action("SafeUploadPhotoFiles", "Inspection")';

    //        $.ajax({
    //            url: _url,
    //            data: formData,
    //            processData: false,
    //            contentType: false,
    //            type: "POST",
    //            success: function (data) {
    //                $("#" + UploadPhotoId).val("");
    //                $("#" + UploadPhotoId).val(data);
    //            }
    //        });
    //    }
    //    else {
    //        $("#" + inputId).val("");
    //        $("#" + UploadPhotoId).val("");
    //        toastr["info"]("Maximum Allowed 5 Files");
    //    }
    //}


    function Upload_Safe_Picture(inputId, UploadPhotoId) {
        var input = document.getElementById(inputId);
        var files = input.files;
        var formData = new FormData();

        if (files.length <= 5) {

            for (var i = 0; i != files.length; i++) {
                formData.append("files", files[i]);
            }

            var _url = '@Url.Action("SafeUploadPicture", "Inspection")';

            $.ajax({
                url: _url,
                data: formData,
                processData: false,
                contentType: false,
                type: "POST",
                success: function (data) {
                    debugger;
                    if (data != "" && data != null) {
                        var Photo_List = [];
                        var val_UploadPhotos = data.split(',');
                        var i;
                        for (i = 0; i < val_UploadPhotos.length; i++) {
                            var x = val_UploadPhotos[i].replace(/[\(\)\[\]{}'"]/g, "");
                            if (x != "/") {
                                var Pdata = {};
                                Pdata.File_Path = x;
                                Photo_List.push(Pdata);
                            }
                        }

                        $(Photo_List).each(function (i, e) {
                            if (e.File_Path == "Invalid Format") {
                                $("#" + inputId).val("");
                                $("#" + UploadPhotoId).val("");
                                toastr["error"]("Invalid Format");
                                return false;
                            } else {
                                $("#" + UploadPhotoId).val("");
                                $("#" + UploadPhotoId).val(data);
                                toastr["success"]("Uploaded Successfully");
                            }
                        });
                    }
                }
            });
        }

        else {
            $("#" + inputId).val("");
            $("#" + UploadPhotoId).val("");
            toastr["info"]("Maximum Allowed 5 Files");
        }
    }

</script>




